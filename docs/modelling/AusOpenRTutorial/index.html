
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation, guides and articles on creating, developing and implementing automated betting strategies, using data analysis to inform betting models and how to interact with the Betfair API.">
      
      
        <meta name="author" content="Betfair Data Scientists">
      
      
        <link rel="canonical" href="https://betfair-datascientists.github.io/modelling/AusOpenRTutorial/">
      
      
        <link rel="prev" href="../howToModelTheAusOpen/">
      
      
        <link rel="next" href="../AusOpenPythonTutorial/">
      
      
      <link rel="icon" href="../../img/BetfairFavicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Aus Open R Tutorial - The Automation Hub</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/betfair.css">
    
      <link rel="stylesheet" href="../../css/buttons_and_animations.css">
    
      <link rel="stylesheet" href="../../css/fonts.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-125973915-1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-125973915-1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-125973915-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="betfair" data-md-color-primary="amber" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#australian-open-datathon-r-tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      
  
  <header class="md-header" data-md-component="header">
    <nav class="md-header__inner md-grid" aria-label="header.title">
      <a href="../.." title="The Automation Hub" class="md-header__button md-logo" aria-label="The Automation Hub" data-md-component="logo">
        
  <img src="../../img/logo.svg" alt="logo">

      </a>
      <label class="md-header__button md-icon" for="__drawer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
      </label>
      <div class="md-header__title" data-md-component="header-title">
        <div class="md-header__ellipsis">
          <div class="md-header__topic">
            <span class="md-ellipsis">
              The Automation Hub
            </span>
          </div>
          <div class="md-header__topic" data-md-component="header-topic">
            <span class="md-ellipsis">
              
                Aus Open R Tutorial
              
            </span>
          </div>
        </div>
      </div>

      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="betfair" data-md-color-primary="amber" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
              </label>
            
          
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
              </label>
            
          
        </form>
      
      

      
     
      <div class="bf-nav">
        <a class="bf-hidable" href="https://www.betfair.com.au/exchange/plus/"><svg class="exchangeLogo" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#"
          xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 38.775 4.59" width="24" height="17">
          <path class="st1" d="m 160.3,-136.95 v 26" />
          <g transform="translate(18.8,-137.15)">
            <path d="m 2.2901089,126.53441 v 5.20093 H -3.3107216 L 7.4888397,144.33446 18.2884,131.73534 h -5.598633 v -5.20093 z m -8.6000974,8.10132 -10.8017585,12.59913 h 5.60083 v 5.2998 h 10.3996581 v -5.2998 h 5.6008306 z" />
          </g>
        </svg><span> Exchange</span></a>
        <a href="https://www.betfair.com.au/hub/">Hub</a>
      </div>

      

    </nav>
    
  </header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data/dataListing/" class="md-tabs__link">
          
  
  Data

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../wagering/betfairHowTo/" class="md-tabs__link">
          
  
  Wagering

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/apiResources/" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../brownlowDatathon/" class="md-tabs__link">
          
  
  Modelling

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/How_to_Automate_1/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mentalGame/intro/" class="md-tabs__link">
          
  
  Mental Game

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contactUs/test/" class="md-tabs__link">
          
  
  Contact Us

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Automation Hub" class="md-nav__button md-logo" aria-label="The Automation Hub" data-md-component="logo">
      
  <img src="../../img/logo.svg" alt="logo">

    </a>
    The Automation Hub
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataListing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSV Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/usingHistoricDataSite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Historic Data Site
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wagering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Wagering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/betfairHowTo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Betfair How-To
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/bettingGlossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Betting Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/stakingMethods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Staking Methods and Bankroll Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/valueAndOdds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Value and Odds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/commission/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commission and other charges
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/hubPredictionsModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hub Predictions Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/2ndPlaceVoid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cashback 2nd Markets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wagering/exactaQuinella/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exactas & Quinella
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiResources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiappkey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to access the Betfair API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiRtutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API tutorial in R
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiPythontutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API tutorial in Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modelling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Modelling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brownlowDatathon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Brownlow Medal Datathon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howToModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to modelling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataSources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pricing Data Sources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudOrLocalMachine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud or Local
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monteCarloSimulations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monte Carlo Simulations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    AFL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            AFL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AFLPlayerDisposalsTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Player Disposal Lines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AFLPlayerDisposalsFlumine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Betting Player Disposal Markets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modellingTheBrownlowMedal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How does a Data Scientist model the Brownlow?
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    AFL (Archive)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            AFL (Archive)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AFLmodellingPython/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AFL modelling walk through in Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brownlowModelTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling the Brownlow Medal in Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Greyhounds
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Greyhounds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topazTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Greyhound Topaz API (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_9" >
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Greyhounds (Archive)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            Greyhounds (Archive)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fasttrackTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Greyhound FastTrack API (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../greyhoundModellingPython/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Greyhound modelling (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Soccer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            Soccer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howToBuildASoccerBotPartI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Build A Soccer Bot P1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howToBuildASoccerBotPartII/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Build A Soccer Bot P2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howToBuildASoccerBotPartIII/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Build A Soccer Bot P3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_11" >
        
          
          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Soccer (Archive)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            Soccer (Archive)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../soccerModellingTutorialPython/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soccer modelling (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../EPLmlPython/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EPL Machine Learning (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../soccerModellingELO2022WorldCup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soccer modelling (R) - 2022 FIFA World Cup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../soccerEloTutorialR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elo soccer tutorial (R)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../soccerModellingTutorialR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soccer modelling (R)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" checked>
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tennis (Archive)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            Tennis (Archive)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howToModelTheAusOpen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to model the Australian Open
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Aus Open R Tutorial
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Aus Open R Tutorial
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-task" class="md-nav__link">
    <span class="md-ellipsis">
      The Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploring-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Exploring the Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Creation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-training-feature-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Training Feature Matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-feature-matrix-for-the-2019-australian-open" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Feature Matrix for the 2019 Australian Open
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-2019-australian-open-predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Generating 2019 Australian Open Predictions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generating 2019 Australian Open Predictions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disclaimer" class="md-nav__link">
    <span class="md-ellipsis">
      Disclaimer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AusOpenPythonTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aus Open Python Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/How_to_Automate_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Automate 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/How_to_Automate_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Automate 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/How_to_Automate_3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Automate 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/How_to_Automate_4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Automate 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/How_to_Automate_5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Automate 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/resultsLoggingTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flumine Results to CSV Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/flumineSimulations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flumine Simulations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/processingTarFiles101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Take away the pain! Processing TAR Files 101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/jsonToCsvRevisited/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON to CSV | Revisited
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/backtestingRatingsTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Back testing ratings in Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/automatedBettingAnglesTutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automated betting angles in Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/analysingAndPredictingMarketMovements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Do they know? Analysing Betfair market formation & market movements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/analysingAndPredictingBSP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wisdom of the crowd? Analysing & understanding BSP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mental Game
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Mental Game
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/roleOfEmotions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/mapYourEmotions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/handlingBadVariance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/winbyBeingGreatatLosing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/correctingyouremotions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/responsibleGambling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/InchwormConcept/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/HighExpectations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mentalGame/TappingYourIntuition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 9
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Contact Us
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contactUs/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet the Team
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="australian-open-datathon-r-tutorial">Australian Open Datathon R Tutorial</h1>
<h2 id="overview">Overview</h2>
<h3 id="the-task">The Task</h3>
<p>This notebook will outline how the Betfair Data Scientists went about modelling the Australian Open for Betfair's Australian Open Datathon. The task is simple: we ask you to predict the winner of every possible Australian Open matchup using data which we provide.</p>
<p>The metric used to determine the winner will be log loss, based on the actual matchups that happen in the Open. For more information on log loss, click <a href="https://en.wikipedia.org/wiki/Cross_entropy">here</a>.</p>
<p>How an outline of our methodology and thought process, read <a href="/modelling/howToModelTheAusOpen">this</a> article.</p>
<hr />
<h2 id="exploring-the-data">Exploring the Data</h2>
<p>First we need to get an idea of what the data looks like. Let's read the men's data in and get an idea of what it looks like. Note that you will need to install all the packages listed below unless you already have them.</p>
<p>Note that for this tutorial I will be using <code>dplyr</code>, if you are not familiar with the syntax I encourage you to read up on <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">the basics</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Import libraries</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nf">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nf">library</span><span class="p">(</span><span class="n">RcppRoll</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nf">library</span><span class="p">(</span><span class="n">tidyselect</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nf">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nf">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nf">library</span><span class="p">(</span><span class="n">zoo</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nf">library</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="nf">library</span><span class="p">(</span><span class="n">h2o</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nf">library</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">mens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/ATP_matches.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># NAs are indicated by .</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">mens</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">  </span><span class="nf">datatable</span><span class="p">(</span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Scroller&#39;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">            </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">dom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">            </span><span class="n">scrollY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">450</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">            </span><span class="n">scroller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">            </span><span class="n">scrollX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">            </span><span class="n">fixedColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">  </span><span class="nf">formatRound</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nf">pluck</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Winner</th>
<th>Loser</th>
<th>Tournament</th>
<th>Tournament_Date</th>
<th>Court_Surface</th>
<th>Round_Description</th>
<th>Winner_Rank</th>
<th>Loser_Rank</th>
<th>Retirement_Ind</th>
<th>Winner_Sets_Won</th>
<th>...</th>
<th>Loser_DoubleFaults</th>
<th>Loser_FirstServes_Won</th>
<th>Loser_FirstServes_In</th>
<th>Loser_SecondServes_Won</th>
<th>Loser_SecondServes_In</th>
<th>Loser_BreakPoints_Won</th>
<th>Loser_BreakPoints</th>
<th>Loser_ReturnPoints_Won</th>
<th>Loser_ReturnPoints_Faced</th>
<th>Loser_TotalPoints_Won</th>
</tr>
</thead>
<tbody>
<tr>
<td>Edouard Roger-Vasselin</td>
<td>Eric Prodon</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>106</td>
<td>97</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>21</td>
<td>33</td>
<td>13</td>
<td>26</td>
<td>1</td>
<td>3</td>
<td>15</td>
<td>49</td>
<td>49</td>
</tr>
<tr>
<td>Dudi Sela</td>
<td>Fabio Fognini</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>83</td>
<td>48</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>17</td>
<td>32</td>
<td>5</td>
<td>26</td>
<td>0</td>
<td>1</td>
<td>8</td>
<td>33</td>
<td>30</td>
</tr>
<tr>
<td>Go Soeda</td>
<td>Frederico Gil</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>120</td>
<td>102</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>45</td>
<td>70</td>
<td>18</td>
<td>35</td>
<td>2</td>
<td>4</td>
<td>36</td>
<td>103</td>
<td>99</td>
</tr>
<tr>
<td>Yuki Bhambri</td>
<td>Karol Beck</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>345</td>
<td>101</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>15</td>
<td>33</td>
<td>13</td>
<td>29</td>
<td>2</td>
<td>3</td>
<td>15</td>
<td>46</td>
<td>43</td>
</tr>
<tr>
<td>Yuichi Sugita</td>
<td>Olivier Rochus</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>235</td>
<td>67</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>19</td>
<td>32</td>
<td>13</td>
<td>22</td>
<td>1</td>
<td>7</td>
<td>30</td>
<td>78</td>
<td>62</td>
</tr>
<tr>
<td>Benoit Paire</td>
<td>Pere Riba</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>95</td>
<td>89</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>13</td>
<td>20</td>
<td>12</td>
<td>32</td>
<td>0</td>
<td>1</td>
<td>9</td>
<td>44</td>
<td>34</td>
</tr>
<tr>
<td>Victor Hanescu</td>
<td>Sam Querrey</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>90</td>
<td>93</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>8</td>
<td>29</td>
<td>41</td>
<td>7</td>
<td>24</td>
<td>1</td>
<td>3</td>
<td>17</td>
<td>57</td>
<td>53</td>
</tr>
<tr>
<td>Yen-Hsun Lu</td>
<td>Thiemo de Bakker</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>82</td>
<td>223</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>20</td>
<td>32</td>
<td>10</td>
<td>24</td>
<td>1</td>
<td>1</td>
<td>19</td>
<td>57</td>
<td>49</td>
</tr>
<tr>
<td>Andreas Beck</td>
<td>Vasek Pospisil</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>98</td>
<td>119</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>39</td>
<td>57</td>
<td>16</td>
<td>38</td>
<td>1</td>
<td>5</td>
<td>24</td>
<td>74</td>
<td>79</td>
</tr>
<tr>
<td>Ivan Dodig</td>
<td>Vishnu Vardhan</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>36</td>
<td>313</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>41</td>
<td>59</td>
<td>13</td>
<td>27</td>
<td>2</td>
<td>8</td>
<td>34</td>
<td>101</td>
<td>88</td>
</tr>
<tr>
<td>David Goffin</td>
<td>Xavier Malisse</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>174</td>
<td>49</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>31</td>
<td>43</td>
<td>19</td>
<td>34</td>
<td>1</td>
<td>4</td>
<td>27</td>
<td>85</td>
<td>77</td>
</tr>
<tr>
<td>David Goffin</td>
<td>Andreas Beck</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>174</td>
<td>98</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>43</td>
<td>71</td>
<td>14</td>
<td>27</td>
<td>2</td>
<td>8</td>
<td>27</td>
<td>82</td>
<td>84</td>
</tr>
<tr>
<td>Dudi Sela</td>
<td>Benoit Paire</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>83</td>
<td>95</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>40</td>
<td>58</td>
<td>21</td>
<td>46</td>
<td>1</td>
<td>7</td>
<td>26</td>
<td>87</td>
<td>87</td>
</tr>
<tr>
<td>Stan Wawrinka</td>
<td>Edouard Roger-Vasselin</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>17</td>
<td>106</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>43</td>
<td>70</td>
<td>16</td>
<td>34</td>
<td>4</td>
<td>6</td>
<td>28</td>
<td>82</td>
<td>87</td>
</tr>
<tr>
<td>Go Soeda</td>
<td>Ivan Dodig</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>120</td>
<td>36</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>31</td>
<td>41</td>
<td>11</td>
<td>28</td>
<td>1</td>
<td>4</td>
<td>23</td>
<td>73</td>
<td>65</td>
</tr>
<tr>
<td>Milos Raonic</td>
<td>Victor Hanescu</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>31</td>
<td>90</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>25</td>
<td>38</td>
<td>5</td>
<td>14</td>
<td>0</td>
<td>4</td>
<td>15</td>
<td>56</td>
<td>45</td>
</tr>
<tr>
<td>Yuichi Sugita</td>
<td>Yen-Hsun Lu</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>235</td>
<td>82</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>34</td>
<td>45</td>
<td>12</td>
<td>34</td>
<td>2</td>
<td>9</td>
<td>38</td>
<td>93</td>
<td>84</td>
</tr>
<tr>
<td>Janko Tipsarevic</td>
<td>Yuki Bhambri</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Second Round</td>
<td>9</td>
<td>345</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>12</td>
<td>22</td>
<td>9</td>
<td>17</td>
<td>0</td>
<td>1</td>
<td>8</td>
<td>41</td>
<td>29</td>
</tr>
<tr>
<td>Janko Tipsarevic</td>
<td>David Goffin</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Quarter-finals</td>
<td>9</td>
<td>174</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>34</td>
<td>51</td>
<td>19</td>
<td>40</td>
<td>1</td>
<td>2</td>
<td>18</td>
<td>67</td>
<td>71</td>
</tr>
<tr>
<td>Milos Raonic</td>
<td>Dudi Sela</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Quarter-finals</td>
<td>31</td>
<td>83</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>23</td>
<td>31</td>
<td>19</td>
<td>28</td>
<td>0</td>
<td>3</td>
<td>16</td>
<td>69</td>
<td>58</td>
</tr>
<tr>
<td>Go Soeda</td>
<td>Stan Wawrinka</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Quarter-finals</td>
<td>120</td>
<td>17</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>18</td>
<td>34</td>
<td>13</td>
<td>31</td>
<td>3</td>
<td>7</td>
<td>31</td>
<td>74</td>
<td>62</td>
</tr>
<tr>
<td>Nicolas Almagro</td>
<td>Yuichi Sugita</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Quarter-finals</td>
<td>10</td>
<td>235</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>36</td>
<td>65</td>
<td>30</td>
<td>40</td>
<td>3</td>
<td>12</td>
<td>45</td>
<td>123</td>
<td>111</td>
</tr>
<tr>
<td>Janko Tipsarevic</td>
<td>Go Soeda</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Semi-finals</td>
<td>9</td>
<td>120</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>21</td>
<td>33</td>
<td>10</td>
<td>28</td>
<td>1</td>
<td>1</td>
<td>10</td>
<td>44</td>
<td>41</td>
</tr>
<tr>
<td>Milos Raonic</td>
<td>Nicolas Almagro</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Semi-finals</td>
<td>31</td>
<td>10</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>31</td>
<td>45</td>
<td>8</td>
<td>15</td>
<td>0</td>
<td>3</td>
<td>12</td>
<td>54</td>
<td>51</td>
</tr>
<tr>
<td>Milos Raonic</td>
<td>Janko Tipsarevic</td>
<td>Chennai</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>Finals</td>
<td>31</td>
<td>9</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>59</td>
<td>83</td>
<td>34</td>
<td>55</td>
<td>0</td>
<td>4</td>
<td>25</td>
<td>113</td>
<td>118</td>
</tr>
<tr>
<td>Igor Andreev</td>
<td>Adrian Mannarino</td>
<td>Brisbane</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>115</td>
<td>87</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>24</td>
<td>35</td>
<td>13</td>
<td>25</td>
<td>1</td>
<td>3</td>
<td>21</td>
<td>70</td>
<td>58</td>
</tr>
<tr>
<td>Alexandr Dolgopolov</td>
<td>Alejandro Falla</td>
<td>Brisbane</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>15</td>
<td>74</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>16</td>
<td>33</td>
<td>12</td>
<td>25</td>
<td>3</td>
<td>7</td>
<td>33</td>
<td>75</td>
<td>61</td>
</tr>
<tr>
<td>Tatsuma Ito</td>
<td>Benjamin Mitchell</td>
<td>Brisbane</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>122</td>
<td>227</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>6</td>
<td>30</td>
<td>44</td>
<td>7</td>
<td>24</td>
<td>0</td>
<td>2</td>
<td>13</td>
<td>52</td>
<td>50</td>
</tr>
<tr>
<td>Kei Nishikori</td>
<td>Cedrik-Marcel Stebe</td>
<td>Brisbane</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>25</td>
<td>81</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>27</td>
<td>49</td>
<td>23</td>
<td>41</td>
<td>3</td>
<td>6</td>
<td>28</td>
<td>75</td>
<td>78</td>
</tr>
<tr>
<td>Denis Istomin</td>
<td>Florian Mayer</td>
<td>Brisbane</td>
<td>2-Jan-12</td>
<td>Hard</td>
<td>First Round</td>
<td>73</td>
<td>23</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>28</td>
<td>38</td>
<td>11</td>
<td>17</td>
<td>0</td>
<td>2</td>
<td>15</td>
<td>56</td>
<td>54</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td></td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>Malek Jaziri</td>
<td>Fernando Verdasco</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>55</td>
<td>27</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>6</td>
<td>46</td>
<td>60</td>
<td>16</td>
<td>35</td>
<td>3</td>
<td>13</td>
<td>39</td>
<td>104</td>
<td>101</td>
</tr>
<tr>
<td>Alexander Zverev</td>
<td>Frances Tiafoe</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>5</td>
<td>44</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>26</td>
<td>40</td>
<td>16</td>
<td>36</td>
<td>2</td>
<td>10</td>
<td>27</td>
<td>72</td>
<td>69</td>
</tr>
<tr>
<td>Dominic Thiem</td>
<td>Gilles Simon</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>8</td>
<td>31</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>13</td>
<td>26</td>
<td>12</td>
<td>25</td>
<td>2</td>
<td>2</td>
<td>23</td>
<td>59</td>
<td>48</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Joao Sousa</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>2</td>
<td>48</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>25</td>
<td>35</td>
<td>6</td>
<td>22</td>
<td>1</td>
<td>10</td>
<td>27</td>
<td>74</td>
<td>58</td>
</tr>
<tr>
<td>Karen Khachanov</td>
<td>Matthew Ebden</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>18</td>
<td>39</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>6</td>
<td>8</td>
<td>18</td>
<td>5</td>
<td>20</td>
<td>1</td>
<td>2</td>
<td>10</td>
<td>30</td>
<td>23</td>
</tr>
<tr>
<td>John Isner</td>
<td>Mikhail Kukushkin</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>9</td>
<td>54</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>54</td>
<td>80</td>
<td>24</td>
<td>39</td>
<td>0</td>
<td>1</td>
<td>13</td>
<td>90</td>
<td>91</td>
</tr>
<tr>
<td>Kevin Anderson</td>
<td>Nikoloz Basilashvili</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>6</td>
<td>22</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>7</td>
<td>43</td>
<td>54</td>
<td>30</td>
<td>49</td>
<td>0</td>
<td>3</td>
<td>26</td>
<td>106</td>
<td>99</td>
</tr>
<tr>
<td>Marin Cilic</td>
<td>Philipp Kohlschreiber</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>7</td>
<td>43</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>19</td>
<td>34</td>
<td>12</td>
<td>20</td>
<td>1</td>
<td>1</td>
<td>17</td>
<td>55</td>
<td>48</td>
</tr>
<tr>
<td>Jack Sock</td>
<td>Richard Gasquet</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>23</td>
<td>28</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>18</td>
<td>33</td>
<td>16</td>
<td>29</td>
<td>0</td>
<td>4</td>
<td>19</td>
<td>59</td>
<td>53</td>
</tr>
<tr>
<td>Grigor Dimitrov</td>
<td>Roberto Bautista Agut</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>10</td>
<td>25</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>34</td>
<td>48</td>
<td>11</td>
<td>20</td>
<td>2</td>
<td>4</td>
<td>27</td>
<td>76</td>
<td>72</td>
</tr>
<tr>
<td>Damir Dzumhur</td>
<td>Stefanos Tsitsipas</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Second Round</td>
<td>52</td>
<td>16</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>14</td>
<td>26</td>
<td>15</td>
<td>30</td>
<td>2</td>
<td>2</td>
<td>17</td>
<td>52</td>
<td>46</td>
</tr>
<tr>
<td>Dominic Thiem</td>
<td>Borna Coric</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>8</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>39</td>
<td>57</td>
<td>16</td>
<td>38</td>
<td>2</td>
<td>2</td>
<td>27</td>
<td>88</td>
<td>82</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Damir Dzumhur</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>2</td>
<td>52</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>15</td>
<td>28</td>
<td>7</td>
<td>18</td>
<td>0</td>
<td>0</td>
<td>8</td>
<td>28</td>
<td>30</td>
</tr>
<tr>
<td>Alexander Zverev</td>
<td>Diego Schwartzman</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>5</td>
<td>19</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>22</td>
<td>37</td>
<td>12</td>
<td>24</td>
<td>0</td>
<td>4</td>
<td>18</td>
<td>58</td>
<td>52</td>
</tr>
<tr>
<td>Roger Federer</td>
<td>Fabio Fognini</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>3</td>
<td>14</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>6</td>
<td>22</td>
<td>32</td>
<td>15</td>
<td>37</td>
<td>1</td>
<td>5</td>
<td>16</td>
<td>54</td>
<td>53</td>
</tr>
<tr>
<td>Marin Cilic</td>
<td>Grigor Dimitrov</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>7</td>
<td>10</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>37</td>
<td>55</td>
<td>14</td>
<td>32</td>
<td>1</td>
<td>5</td>
<td>22</td>
<td>71</td>
<td>73</td>
</tr>
<tr>
<td>Karen Khachanov</td>
<td>John Isner</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>18</td>
<td>9</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>67</td>
<td>80</td>
<td>19</td>
<td>38</td>
<td>0</td>
<td>0</td>
<td>17</td>
<td>100</td>
<td>103</td>
</tr>
<tr>
<td>Kei Nishikori</td>
<td>Kevin Anderson</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>11</td>
<td>6</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>26</td>
<td>33</td>
<td>11</td>
<td>19</td>
<td>0</td>
<td>0</td>
<td>11</td>
<td>51</td>
<td>48</td>
</tr>
<tr>
<td>Jack Sock</td>
<td>Malek Jaziri</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Third Round</td>
<td>23</td>
<td>55</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>6</td>
<td>13</td>
<td>21</td>
<td>10</td>
<td>24</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>41</td>
<td>32</td>
</tr>
<tr>
<td>Karen Khachanov</td>
<td>Alexander Zverev</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Quarter-finals</td>
<td>18</td>
<td>5</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>7</td>
<td>26</td>
<td>47</td>
<td>4</td>
<td>21</td>
<td>1</td>
<td>3</td>
<td>10</td>
<td>36</td>
<td>40</td>
</tr>
<tr>
<td>Dominic Thiem</td>
<td>Jack Sock</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Quarter-finals</td>
<td>8</td>
<td>23</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>44</td>
<td>59</td>
<td>19</td>
<td>37</td>
<td>2</td>
<td>10</td>
<td>34</td>
<td>97</td>
<td>97</td>
</tr>
<tr>
<td>Roger Federer</td>
<td>Kei Nishikori</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Quarter-finals</td>
<td>3</td>
<td>11</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>21</td>
<td>37</td>
<td>16</td>
<td>26</td>
<td>0</td>
<td>1</td>
<td>12</td>
<td>56</td>
<td>49</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Marin Cilic</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Quarter-finals</td>
<td>2</td>
<td>7</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>38</td>
<td>55</td>
<td>11</td>
<td>28</td>
<td>2</td>
<td>5</td>
<td>29</td>
<td>85</td>
<td>78</td>
</tr>
<tr>
<td>Karen Khachanov</td>
<td>Dominic Thiem</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Semi-finals</td>
<td>18</td>
<td>8</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>19</td>
<td>29</td>
<td>8</td>
<td>26</td>
<td>1</td>
<td>3</td>
<td>15</td>
<td>47</td>
<td>42</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Roger Federer</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Semi-finals</td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>69</td>
<td>93</td>
<td>25</td>
<td>46</td>
<td>1</td>
<td>2</td>
<td>29</td>
<td>113</td>
<td>123</td>
</tr>
<tr>
<td>Karen Khachanov</td>
<td>Novak Djokovic</td>
<td>Paris</td>
<td>29-Oct-18</td>
<td>Indoor Hard</td>
<td>Finals</td>
<td>18</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>30</td>
<td>43</td>
<td>14</td>
<td>28</td>
<td>1</td>
<td>5</td>
<td>20</td>
<td>66</td>
<td>64</td>
</tr>
<tr>
<td>Jaume Antoni Munar Clar</td>
<td>Frances Tiafoe</td>
<td>Milan</td>
<td>5-Nov-18</td>
<td>Indoor Hard</td>
<td>NA</td>
<td>76</td>
<td>40</td>
<td>0</td>
<td>3</td>
<td>...</td>
<td>3</td>
<td>21</td>
<td>29</td>
<td>6</td>
<td>17</td>
<td>0</td>
<td>2</td>
<td>5</td>
<td>46</td>
<td>32</td>
</tr>
<tr>
<td>Frances Tiafoe</td>
<td>Hubert Hurkacz</td>
<td>Milan</td>
<td>5-Nov-18</td>
<td>Indoor Hard</td>
<td>NA</td>
<td>40</td>
<td>85</td>
<td>0</td>
<td>3</td>
<td>...</td>
<td>4</td>
<td>35</td>
<td>48</td>
<td>10</td>
<td>19</td>
<td>1</td>
<td>7</td>
<td>22</td>
<td>78</td>
<td>67</td>
</tr>
<tr>
<td>Hubert Hurkacz</td>
<td>Jaume Antoni Munar Clar</td>
<td>Milan</td>
<td>5-Nov-18</td>
<td>Indoor Hard</td>
<td>NA</td>
<td>85</td>
<td>76</td>
<td>0</td>
<td>3</td>
<td>...</td>
<td>1</td>
<td>43</td>
<td>63</td>
<td>15</td>
<td>35</td>
<td>3</td>
<td>9</td>
<td>29</td>
<td>80</td>
<td>87</td>
</tr>
<tr>
<td>Andrey Rublev</td>
<td>Liam Caruana</td>
<td>Milan</td>
<td>5-Nov-18</td>
<td>Indoor Hard</td>
<td>NA</td>
<td>68</td>
<td>NA</td>
<td>0</td>
<td>3</td>
<td>...</td>
<td>1</td>
<td>28</td>
<td>39</td>
<td>4</td>
<td>14</td>
<td>1</td>
<td>3</td>
<td>18</td>
<td>57</td>
<td>50</td>
</tr>
</tbody>
</table>
<p>As we can see, we have a <code>Winner</code> column, a <code>Loser</code> column, as well as other columns detailing the match details, and other columns which have the stats for that match. As we have a <code>Winner</code> column, if we use the current data structure to train a model we will leak the result. The model will simply learn that the actual winner comes from the <code>Winner</code> column, rather than learning from other features that we can create, such as <code>First Serve %</code>.</p>
<p>To avoid this problem, let's reshape the data from wide to long, then shuffle the data. For this, we will define a function, <code>split_winner_loser_columns</code>, which splits the raw data frame into two data frames, appends them together, and then shuffles the data.</p>
<p>Let's also remove all Grass and Clay matches from our data, as we will be modelling the Australian Open which is a hardcourt surface.</p>
<p>Additionally, we will add a few columns, such as <code>Match_Id</code> and <code>Total_Games</code>. These will be useful later.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">split_winner_loser_columns</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="c1"># This function splits the raw data into two data frames and appends them together then shuffles them</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="c1"># This output is a data frame with only one player&#39;s stats on each row (i.e. in long format)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="c1"># Grab a df with only the Winner&#39;s stats</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="n">winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Loser&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Select only the Winner columns + extra game info columns as a df</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="nf">rename_at</span><span class="p">(</span><span class="w"> </span><span class="c1"># Rename all columns containing &quot;Winner&quot; to &quot;Player&quot; </span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">      </span><span class="nf">vars</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Winner&quot;</span><span class="p">)),</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">      </span><span class="o">~</span><span class="nf">str_replace</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Winner&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Player&quot;</span><span class="p">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># Create a target column</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">  </span><span class="c1"># Repeat the process with the loser&#39;s stats</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">  </span><span class="n">loser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Winner&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">    </span><span class="nf">rename_at</span><span class="p">(</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">      </span><span class="nf">vars</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Loser&quot;</span><span class="p">)),</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">      </span><span class="o">~</span><span class="nf">str_replace</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Loser&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Player&quot;</span><span class="p">)</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">  </span><span class="nf">set.seed</span><span class="p">(</span><span class="m">183</span><span class="p">)</span><span class="w"> </span><span class="c1"># Set seed to replicate results - 183 is the most games played in a tennis match (Isner-Mahut)</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="w">  </span><span class="c1"># Create a df that appends both the Winner and loser df together</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="w">  </span><span class="n">combined_df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">winner</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="w">    </span><span class="nf">rbind</span><span class="p">(</span><span class="n">loser</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Append the loser df to the Winner df</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="w">    </span><span class="nf">slice</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">n</span><span class="p">()))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Randomise row order</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="w">    </span><span class="nf">arrange</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Arrange by Match_Id</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="w">    </span><span class="kr">return</span><span class="p">()</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Read in men and womens data; randomise the data to avoid result leakage</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">mens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/ATP_matches.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">Court_Surface</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Hard&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Court_Surface</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Indoor Hard&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Filter to only use hardcourt games</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Match_Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">row_number</span><span class="p">(),</span><span class="w"> </span><span class="c1"># Add a match ID column to be used as a key</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">         </span><span class="n">Tournament_Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dmy</span><span class="p">(</span><span class="n">Tournament_Date</span><span class="p">),</span><span class="w"> </span><span class="c1"># Change Tournament to datetime</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">         </span><span class="n">Total_Games</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Winner_Games_Won</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Loser_Games_Won</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Add a total games played column</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="nf">split_winner_loser_columns</span><span class="p">()</span><span class="w"> </span><span class="c1"># Change the data frame from wide to long</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">mens</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">  </span><span class="nf">datatable</span><span class="p">(</span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Scroller&#39;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">            </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">dom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">            </span><span class="n">scrollY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">450</span><span class="p">,</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">            </span><span class="n">scroller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">            </span><span class="n">scrollX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">,</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">            </span><span class="n">fixedColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">  </span><span class="nf">formatRound</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nf">pluck</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Player</th>
<th>Tournament</th>
<th>Tournament_Date</th>
<th>Court_Surface</th>
<th>Round_Description</th>
<th>Player_Rank</th>
<th>Retirement_Ind</th>
<th>Player_Sets_Won</th>
<th>Player_Games_Won</th>
<th>Player_Aces</th>
<th>...</th>
<th>Player_SecondServes_Won</th>
<th>Player_SecondServes_In</th>
<th>Player_BreakPoints_Won</th>
<th>Player_BreakPoints</th>
<th>Player_ReturnPoints_Won</th>
<th>Player_ReturnPoints_Faced</th>
<th>Player_TotalPoints_Won</th>
<th>Match_Id</th>
<th>Total_Games</th>
<th>Winner</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eric Prodon</td>
<td>Chennai</td>
<td>2012-01-02</td>
<td>Hard</td>
<td>First Round</td>
<td>97</td>
<td>0</td>
<td>0</td>
<td>7</td>
<td>2</td>
<td>...</td>
<td>13</td>
<td>26</td>
<td>1</td>
<td>3</td>
<td>15</td>
<td>49</td>
<td>49</td>
<td>1</td>
<td>19</td>
<td>0</td>
</tr>
<tr>
<td>Edouard Roger-Vasselin</td>
<td>Chennai</td>
<td>2012-01-02</td>
<td>Hard</td>
<td>First Round</td>
<td>106</td>
<td>0</td>
<td>2</td>
<td>12</td>
<td>5</td>
<td>...</td>
<td>12</td>
<td>19</td>
<td>4</td>
<td>7</td>
<td>25</td>
<td>59</td>
<td>59</td>
<td>1</td>
<td>19</td>
<td>1</td>
</tr>
<tr>
<td>Dudi Sela</td>
<td>Chennai</td>
<td>2012-01-02</td>
<td>Hard</td>
<td>First Round</td>
<td>83</td>
<td>0</td>
<td>2</td>
<td>12</td>
<td>2</td>
<td>...</td>
<td>11</td>
<td>16</td>
<td>6</td>
<td>14</td>
<td>36</td>
<td>58</td>
<td>61</td>
<td>2</td>
<td>13</td>
<td>1</td>
</tr>
<tr>
<td>Fabio Fognini</td>
<td>Chennai</td>
<td>2012-01-02</td>
<td>Hard</td>
<td>First Round</td>
<td>48</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>5</td>
<td>26</td>
<td>0</td>
<td>1</td>
<td>8</td>
<td>33</td>
<td>30</td>
<td>2</td>
<td>13</td>
<td>0</td>
</tr>
<tr>
<td>Frederico Gil</td>
<td>Chennai</td>
<td>2012-01-02</td>
<td>Hard</td>
<td>First Round</td>
<td>102</td>
<td>0</td>
<td>1</td>
<td>14</td>
<td>5</td>
<td>...</td>
<td>18</td>
<td>35</td>
<td>2</td>
<td>4</td>
<td>36</td>
<td>103</td>
<td>99</td>
<td>3</td>
<td>33</td>
<td>0</td>
</tr>
<tr>
<td>Go Soeda</td>
<td>Chennai</td>
<td>2012-01-02</td>
<td>Hard</td>
<td>First Round</td>
<td>120</td>
<td>0</td>
<td>2</td>
<td>19</td>
<td>6</td>
<td>...</td>
<td>19</td>
<td>39</td>
<td>5</td>
<td>11</td>
<td>42</td>
<td>105</td>
<td>109</td>
<td>3</td>
<td>33</td>
<td>1</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="feature-creation">Feature Creation</h2>
<p>Now that we have a fairly good understanding of what the data looks like, let's add some features. To do this we will define a function. Ideally we want to add features which will provide predictive power to our model. </p>
<p>Thinking about the dynamics of tennis, we know that players often will matches by "breaking" the opponent's serve (i.e. winning a game when the opponent is serving). This is especially important in mens tennis. Let's create a feature called <code>F_Player_BreakPoints_Per_Game</code>, which is the number of breakpoints a player gets per game that they play (even though they can only get breakpoints every second game, we will use total games). Let's also create a feature called <code>F_Player_Return_Win_Ratio</code> which is the proportion of points won when returning.</p>
<p>Similarly, "holding" serve is important (i.e. winning a game when you are serving). Let's create a feature called <code>F_Player_Serve_Win_Ratio</code> which is the proportion of points won when serving.</p>
<p>Finally, you only win a set of tennis by winning more sets than your opponent. To win a set, you need to win games. Let's create a feature called <code>F_Player_Game_Win_Percentage</code> which is the propotion of games that a player wins.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">add_ratio_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="c1"># This function adds ratio features to a long df</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nf">mutate</span><span class="p">(</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">      </span><span class="c1"># Point Win ratio when serving</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">      </span><span class="n">F_Player_Serve_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Player_FirstServes_Won</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Player_SecondServes_Won</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Player_DoubleFaults</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">        </span><span class="p">(</span><span class="n">Player_FirstServes_In</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Player_SecondServes_In</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Player_DoubleFaults</span><span class="p">),</span><span class="w"> </span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">      </span><span class="c1"># Point win ratio when returning</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">      </span><span class="n">F_Player_Return_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Player_ReturnPoints_Won</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Player_ReturnPoints_Faced</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">      </span><span class="c1"># Breakpoints per receiving game</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">      </span><span class="n">F_Player_BreakPoints_Per_Game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Player_BreakPoints</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Total_Games</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">      </span><span class="n">F_Player_Game_Win_Percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Player_Games_Won</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Total_Games</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="nf">mutate_at</span><span class="p">(</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">      </span><span class="nf">vars</span><span class="p">(</span><span class="nf">colnames</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Rank&quot;</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="n">Tournament_Date</span><span class="p">),</span><span class="w"> </span><span class="c1"># Replace all NAs with0 apart from Rank, Date</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">      </span><span class="o">~</span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">.</span><span class="p">)</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">    </span><span class="kr">return</span><span class="p">()</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="p">}</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="n">mens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mens</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">  </span><span class="nf">add_ratio_features</span><span class="p">()</span><span class="w"> </span><span class="c1"># Add features</span>
</code></pre></div>
<p>Now that we have added our features, we need to create rolling averages for them. We cannot simply use current match statistics, as they will leak the result to the model. Instead, we need to use past match statistics to predict future matches. Here we will use a rolling mean with a window of 15. If the player hasn't played 15 games, we will instead use a cumulative mean. We will also lag the result so as to not leak the result.</p>
<p>This next chunk of code simply takes all the columns starting with F_ and calculates these means.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">mens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mens</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Group by player</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nf">mutate_at</span><span class="p">(</span><span class="w"> </span><span class="c1"># Create a rolling mean with window 15 for each player. </span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="nf">vars</span><span class="p">(</span><span class="nf">starts_with</span><span class="p">(</span><span class="s">&quot;F_&quot;</span><span class="p">)),</span><span class="w"> </span><span class="c1"># If the player hasn&#39;t played 15 games, use a cumulative mean</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="o">~</span><span class="nf">coalesce</span><span class="p">(</span><span class="nf">rollmean</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;right&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA_real_</span><span class="p">),</span><span class="w"> </span><span class="nf">cummean</span><span class="p">(</span><span class="n">.</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">lag</span><span class="p">()</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nf">ungroup</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="creating-a-training-feature-matrix">Creating a Training Feature Matrix</h2>
<p>In predictive modelling language - features are data metrics we use to predict an outcome or target variable. We have several choices to make before we get to the prediction phase. What are the features? How do we structure the outcome variable? What does each row mean? Do we use all data or just a subset? We narrowed it down to two options</p>
<p>We can train the model on every tennis match in the data set, or
We can only train the model on Australian Open matches.
Doing Option 1 would mean we have a lot more data to build a strong model, but it might be challenging to work around the constraints described in the tournament structure.</p>
<p>Doing Option 2 fits better from that angle but leaves us with very few matches to train our model on.</p>
<p>We have decided to go with an option that combines strengths from both approaches, by training the model on matches from the Aus Open and the US Open because both grand slams are played on the same surface - hard court.</p>
<p>However, we also need to train our model in the same way that will be used to predict the 2019 Australian Open. When predicting the 2nd round, we won't have data from the 1st round. So we will need to build our training feature matrix with this in mind. We should extract features for a player from past games at the start of the tournament and apply them to every matchup that that player plays.</p>
<p>To do this, we will create a function, <code>extract_latest_features_for_tournament</code>, which maps over our feature data frame for the dates in the first round of a tournament and grabs features.</p>
<p>First, we need the Australian Open and US Open results - let's grab these and then apply our function.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Get Australian Open and US Open Results</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">aus_us_open_results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="n">mens</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nf">filter</span><span class="p">((</span><span class="n">Tournament</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Australian Open, Melbourne&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Tournament</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;U.S. Open, New York&quot;</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">         </span><span class="o">&amp;</span><span class="w"> </span><span class="n">Round_Description</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;Qualifying&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">Tournament_Date</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;2012-01-16&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Filter out qualifiers</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">,</span><span class="w"> </span><span class="n">Player</span><span class="p">,</span><span class="w"> </span><span class="n">Tournament</span><span class="p">,</span><span class="w"> </span><span class="n">Tournament_Date</span><span class="p">,</span><span class="w"> </span><span class="n">Round_Description</span><span class="p">,</span><span class="w"> </span><span class="n">Winner</span><span class="p">)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># Create a function which extracts features for each tournament</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">extract_latest_features_for_tournament</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">dte</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Filter for the 1st round</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">Tournament_Date</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">dte</span><span class="p">,</span><span class="w"> </span><span class="n">Round_Description</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;First Round&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Tournament_Date</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;2012-01-16&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Group by player</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="nf">select_at</span><span class="p">(</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">      </span><span class="nf">vars</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">,</span><span class="w"> </span><span class="nf">starts_with</span><span class="p">(</span><span class="s">&quot;F_&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">Player_Rank</span><span class="p">)</span><span class="w"> </span><span class="c1"># Grab the players&#39; features</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">    </span><span class="nf">rename</span><span class="p">(</span><span class="n">F_Player_Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Player_Rank</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Feature_Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dte</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">    </span><span class="nf">select</span><span class="p">(</span><span class="n">Player</span><span class="p">,</span><span class="w"> </span><span class="n">Feature_Date</span><span class="p">,</span><span class="w"> </span><span class="nf">everything</span><span class="p">())</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="p">}</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="c1"># Create a feature matrix in long format</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="n">feature_matrix_long</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">  </span><span class="n">aus_us_open_results</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">  </span><span class="nf">distinct</span><span class="p">(</span><span class="n">Tournament_Date</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Pull all Tournament Dates</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">  </span><span class="nf">pull</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="w">  </span><span class="nf">map_dfr</span><span class="p">(</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">    </span><span class="o">~</span><span class="nf">extract_latest_features_for_tournament</span><span class="p">(</span><span class="n">mens</span><span class="p">,</span><span class="w"> </span><span class="n">.</span><span class="p">)</span><span class="w"> </span><span class="c1"># Get the features</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">Feature_Date</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;2012-01-16&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Filter out the first Aus Open</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="w">  </span><span class="nf">mutate_at</span><span class="p">(</span><span class="w"> </span><span class="c1"># Replace NAs with the mean</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="w">    </span><span class="nf">vars</span><span class="p">(</span><span class="nf">starts_with</span><span class="p">(</span><span class="s">&quot;F_&quot;</span><span class="p">)),</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">    </span><span class="o">~</span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">.</span><span class="p">)</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="w">  </span><span class="p">)</span>
</code></pre></div>
<p>Now that we have a feature matrix in long format, we need to convert it to wide format so that the features are on the same row. To do this we will define a function <code>gather_df</code>, which converts the data frame from long to wide.
Let's also join the results to the matrix and convert the <code>Winner</code> column to a factor. Finally, we will take the difference of player1 and player2's features, so as to reduce the dimensionality of the model.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">gather_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="c1"># This function puts the df back into its original format of each row containing stats for both players</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="nf">arrange</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="nf">row_number</span><span class="p">()</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Filter for every 2nd row, starting at the 1st index. e.g. 1, 3, 5</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="nf">rename_at</span><span class="p">(</span><span class="w"> </span><span class="c1"># Rename columns to player_1</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">      </span><span class="nf">vars</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Player&quot;</span><span class="p">)),</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">      </span><span class="o">~</span><span class="nf">str_replace</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Player&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;player_1&quot;</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span><span class="nf">inner_join</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">                 </span><span class="nf">filter</span><span class="p">(</span><span class="nf">row_number</span><span class="p">()</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">                 </span><span class="nf">rename_at</span><span class="p">(</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">                   </span><span class="nf">vars</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Player&quot;</span><span class="p">)),</span><span class="w"> </span><span class="c1"># Rename columns to player_2</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">                   </span><span class="o">~</span><span class="nf">str_replace</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Player&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;player_2&quot;</span><span class="p">)</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">                 </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">                 </span><span class="nf">select</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">,</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Player&quot;</span><span class="p">)),</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">               </span><span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;Match_Id&#39;</span><span class="p">)</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="nf">select</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">,</span><span class="w"> </span><span class="n">player_1</span><span class="p">,</span><span class="w"> </span><span class="n">player_2</span><span class="p">,</span><span class="w"> </span><span class="n">Winner</span><span class="p">,</span><span class="w"> </span><span class="nf">everything</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span><span class="kr">return</span><span class="p">()</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="p">}</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="c1"># Joining results to features</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="n">feature_matrix_wide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aus_us_open_results</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">  </span><span class="nf">inner_join</span><span class="p">(</span><span class="n">feature_matrix_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">               </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">Match_Id</span><span class="p">),</span><span class="w"> </span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">             </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Player&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Tournament_Date&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Feature_Date&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">  </span><span class="nf">gather_df</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">    </span><span class="n">F_Serve_Win_Ratio_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_Serve_Win_Ratio</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Serve_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w">    </span><span class="n">F_Return_Win_Ratio_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_Return_Win_Ratio</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Return_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="w">    </span><span class="n">F_Game_Win_Percentage_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_Game_Win_Percentage</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Game_Win_Percentage</span><span class="p">,</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="w">    </span><span class="n">F_BreakPoints_Per_Game_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_BreakPoints_Per_Game</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_BreakPoints_Per_Game</span><span class="p">,</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="w">    </span><span class="n">F_Rank_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">F_player_1_Rank</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Rank</span><span class="p">),</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="w">    </span><span class="n">Winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">Winner</span><span class="p">)</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">Match_Id</span><span class="p">,</span><span class="w"> </span><span class="n">player_1</span><span class="p">,</span><span class="w"> </span><span class="n">player_2</span><span class="p">,</span><span class="w"> </span><span class="n">Tournament</span><span class="p">,</span><span class="w"> </span><span class="n">Tournament_Date</span><span class="p">,</span><span class="w"> </span><span class="n">Round_Description</span><span class="p">,</span><span class="w"> </span><span class="n">Winner</span><span class="p">,</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Diff&quot;</span><span class="p">))</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="n">train</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feature_matrix_wide</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">  </span><span class="nf">datatable</span><span class="p">(</span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Scroller&#39;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="w">            </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">dom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="w">            </span><span class="n">scrollY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">450</span><span class="p">,</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="w">            </span><span class="n">scroller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="w">            </span><span class="n">scrollX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">,</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a><span class="w">            </span><span class="n">fixedColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a><span class="w">  </span><span class="nf">formatRound</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nf">pluck</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Match_Id</th>
<th>player_1</th>
<th>player_2</th>
<th>Tournament</th>
<th>Tournament_Date</th>
<th>Round_Description</th>
<th>Winner</th>
<th>F_Serve_Win_Ratio_Diff</th>
<th>F_Return_Win_Ratio_Diff</th>
<th>F_Game_Win_Percentage_Diff</th>
<th>F_BreakPoints_Per_Game_Diff</th>
<th>F_Rank_Diff</th>
</tr>
</thead>
<tbody>
<tr>
<td>1139</td>
<td>Adrian Ungur</td>
<td>Daniel Brands</td>
<td>U.S. Open, New York</td>
<td>2012-08-27</td>
<td>First Round</td>
<td>0</td>
<td>0.03279412</td>
<td>-0.014757229</td>
<td>0.002877458</td>
<td>0.073938088</td>
<td>-13</td>
</tr>
<tr>
<td>1140</td>
<td>Albert Montanes</td>
<td>Richard Gasquet</td>
<td>U.S. Open, New York</td>
<td>2012-08-27</td>
<td>First Round</td>
<td>0</td>
<td>-0.08000322</td>
<td>-0.077451342</td>
<td>-0.131108056</td>
<td>-0.180846832</td>
<td>97</td>
</tr>
<tr>
<td>1141</td>
<td>Martin Klizan</td>
<td>Alejandro Falla</td>
<td>U.S. Open, New York</td>
<td>2012-08-27</td>
<td>First Round</td>
<td>1</td>
<td>0.07711693</td>
<td>-0.044715517</td>
<td>0.068179841</td>
<td>-0.087361962</td>
<td>1</td>
</tr>
<tr>
<td>1142</td>
<td>Alex Bogomolov Jr.</td>
<td>Andy Murray</td>
<td>U.S. Open, New York</td>
<td>2012-08-27</td>
<td>First Round</td>
<td>0</td>
<td>-0.03964074</td>
<td>-0.031700826</td>
<td>-0.059010072</td>
<td>-0.094721700</td>
<td>69</td>
</tr>
<tr>
<td>1143</td>
<td>Tommy Robredo</td>
<td>Andreas Seppi</td>
<td>U.S. Open, New York</td>
<td>2012-08-27</td>
<td>First Round</td>
<td>1</td>
<td>-0.02681392</td>
<td>0.006442134</td>
<td>-0.067779660</td>
<td>-0.009930089</td>
<td>151</td>
</tr>
<tr>
<td>1144</td>
<td>Ryan Harrison</td>
<td>Benjamin Becker</td>
<td>U.S. Open, New York</td>
<td>2012-08-27</td>
<td>First Round</td>
<td>1</td>
<td>0.04251983</td>
<td>0.018604623</td>
<td>0.026486753</td>
<td>-0.003548973</td>
<td>-24</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="creating-the-feature-matrix-for-the-2019-australian-open">Creating the Feature Matrix for the 2019 Australian Open</h2>
<p>Now that we have our training set, <code>train</code>, we need to create a feature matrix to create predictions on. To do this, we need to generate features again. We could simply append a player list to our raw data frame, create a mock date and then use the <code>extract_latest_features_for_tournament</code> function that we used before. 
Instead, we're going to create a lookup table for each unique player in the 2019 Australian Open. We will need to get their last 15 games and then find the mean for each feature so that our features are the same.</p>
<p>Let's first explore what the dummy submission file looks like, then use it to get the unique players.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/men_dummy_submission_file.csv&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">glimpse</span><span class="p">()</span>
</code></pre></div>
<p>As we can see, the dummy submission file contains every potential match up for the Open. This will be updated a few days before the Open starts with the actual players playing. Let's now create the lookup feature table.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Get a vector of unique players in this years&#39; open using the dummy submission file</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">unique_players</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/men_dummy_submission_file.csv&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span><span class="n">player_1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">unique</span><span class="p">()</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1"># Get the last 15 games played for each unique player and find their features</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">lookup_feature_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/ATP_matches.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">Court_Surface</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Hard&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Court_Surface</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Indoor Hard&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Match_Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">row_number</span><span class="p">(),</span><span class="w"> </span><span class="c1"># Add a match ID column to be used as a key</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">         </span><span class="n">Tournament_Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dmy</span><span class="p">(</span><span class="n">Tournament_Date</span><span class="p">),</span><span class="w"> </span><span class="c1"># Change Tournament to datetime</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">         </span><span class="n">Total_Games</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Winner_Games_Won</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Loser_Games_Won</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Add a total games played column</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">  </span><span class="c1"># clean_missing_data() %&gt;% # Clean missing data</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span><span class="nf">split_winner_loser_columns</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Change the data frame from wide to long</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">  </span><span class="nf">add_ratio_features</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">Player</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">unique_players</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Player</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">  </span><span class="nf">top_n</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">Match_Id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span><span class="nf">summarise</span><span class="p">(</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">    </span><span class="n">F_Player_Serve_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">F_Player_Serve_Win_Ratio</span><span class="p">),</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">    </span><span class="n">F_Player_Return_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">F_Player_Return_Win_Ratio</span><span class="p">),</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="n">F_Player_BreakPoints_Per_Game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">F_Player_BreakPoints_Per_Game</span><span class="p">),</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span><span class="n">F_Player_Game_Win_Percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">F_Player_Game_Win_Percentage</span><span class="p">),</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">    </span><span class="n">F_Player_Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">last</span><span class="p">(</span><span class="n">Player_Rank</span><span class="p">)</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">  </span><span class="p">)</span>
</code></pre></div>
<p>Now let's create features for every single combination. To do this we'll join our <code>lookup_feature_table</code> to the <code>player_1</code> and <code>player_2</code> columns in the <code>dummy_submission_file</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Create feature matrix for the Australian Open for all player 1s</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">features_player_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/men_dummy_submission_file.csv&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">player_1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="nf">inner_join</span><span class="p">(</span><span class="n">lookup_feature_table</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;player_1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Player&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="nf">rename</span><span class="p">(</span><span class="n">F_player_1_Serve_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Serve_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">         </span><span class="n">F_player_1_Return_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Return_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">         </span><span class="n">F_player_1_BreakPoints_Per_Game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_BreakPoints_Per_Game</span><span class="p">,</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">         </span><span class="n">F_player_1_Game_Win_Percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Game_Win_Percentage</span><span class="p">,</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">         </span><span class="n">F_player_1_Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Rank</span><span class="p">)</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="c1"># Create feature matrix for the Australian Open for all player 2s</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="n">features_player_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/men_dummy_submission_file.csv&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">player_2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span><span class="nf">inner_join</span><span class="p">(</span><span class="n">lookup_feature_table</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;player_2&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Player&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">  </span><span class="nf">rename</span><span class="p">(</span><span class="n">F_player_2_Serve_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Serve_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">         </span><span class="n">F_player_2_Return_Win_Ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Return_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">         </span><span class="n">F_player_2_BreakPoints_Per_Game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_BreakPoints_Per_Game</span><span class="p">,</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">         </span><span class="n">F_player_2_Game_Win_Percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Game_Win_Percentage</span><span class="p">,</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">         </span><span class="n">F_player_2_Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_Player_Rank</span><span class="p">)</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="c1"># Join the two dfs together and subtract features to create Difference features</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="n">aus_open_2019_features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">features_player_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">  </span><span class="nf">bind_cols</span><span class="p">(</span><span class="n">features_player_2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">player_1</span><span class="p">,</span><span class="w"> </span><span class="n">player_2</span><span class="p">,</span><span class="w"> </span><span class="nf">everything</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">    </span><span class="n">F_Serve_Win_Ratio_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_Serve_Win_Ratio</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Serve_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">    </span><span class="n">F_Return_Win_Ratio_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_Return_Win_Ratio</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Return_Win_Ratio</span><span class="p">,</span>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">    </span><span class="n">F_Game_Win_Percentage_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_Game_Win_Percentage</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Game_Win_Percentage</span><span class="p">,</span>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">    </span><span class="n">F_BreakPoints_Per_Game_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_player_1_BreakPoints_Per_Game</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_BreakPoints_Per_Game</span><span class="p">,</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="n">F_Rank_Diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">F_player_1_Rank</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_player_2_Rank</span><span class="p">)</span>
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">player_1</span><span class="p">,</span><span class="w"> </span><span class="n">player_2</span><span class="p">,</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Diff&quot;</span><span class="p">))</span>
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="n">aus_open_2019_features</span><span class="w">  </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="w">  </span><span class="nf">datatable</span><span class="p">(</span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Scroller&#39;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="w">            </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">dom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t&quot;</span><span class="p">,</span>
<a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="w">                          </span><span class="n">scrollY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">450</span><span class="p">,</span>
<a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="w">                          </span><span class="n">scroller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="w">                          </span><span class="n">scrollX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">,</span>
<a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="w">                          </span><span class="n">fixedColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="w">  </span><span class="nf">formatRound</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nf">pluck</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>player_1</th>
<th>player_2</th>
<th>F_Serve_Win_Ratio_Diff</th>
<th>F_Return_Win_Ratio_Diff</th>
<th>F_Game_Win_Percentage_Diff</th>
<th>F_BreakPoints_Per_Game_Diff</th>
<th>F_Rank_Diff</th>
</tr>
</thead>
<tbody>
<tr>
<td>Novak Djokovic</td>
<td>Rafael Nadal</td>
<td>0.06347805</td>
<td>0.02503802</td>
<td>0.07002382</td>
<td>0.08951024</td>
<td>1</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Roger Federer</td>
<td>0.06583364</td>
<td>0.03628491</td>
<td>0.07661295</td>
<td>0.15455628</td>
<td>-1</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Juan Martin del Potro</td>
<td>0.01067079</td>
<td>0.03436023</td>
<td>0.06382353</td>
<td>0.11259979</td>
<td>-2</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Alexander Zverev</td>
<td>0.11117863</td>
<td>0.03125651</td>
<td>0.11055585</td>
<td>0.08661036</td>
<td>-3</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Kevin Anderson</td>
<td>0.02132375</td>
<td>0.10449337</td>
<td>0.11184503</td>
<td>0.23684083</td>
<td>-4</td>
</tr>
<tr>
<td>Novak Djokovic</td>
<td>Marin Cilic</td>
<td>0.08410746</td>
<td>0.02434916</td>
<td>0.07653035</td>
<td>0.08355134</td>
<td>-5</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="generating-2019-australian-open-predictions">Generating 2019 Australian Open Predictions</h2>
<p>Now that we have our features, we can finally train our model and generate predictions for the 2019 Australian Open. Due to its simplicity, we will use h2o's Auto Machine Learning function <code>h2o.automl</code>. This will train a heap of different models and optimise the hyperparameters, as well as creating stacked ensembles automatically for us. We will use optimising by log loss.</p>
<p>First, we must create h2o frames for our training and feature data frames. Then we will run <code>h2o.automl</code>. Note that we can set the <code>max_runtime_secs</code> parameter. As this is a notebook, I have set it for 30 seconds - but I suggest you give it 10 minutes to create the best model. We can then create our predictions and assign them back to our <code>aus_open_2019_features</code> data frame. Finally, we will group_by player and find the best player, on average.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">## Setup H2O</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nf">h2o.init</span><span class="p">(</span><span class="n">ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span><span class="p">,</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">         </span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">54321</span><span class="p">,</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">         </span><span class="n">enable_assertions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">         </span><span class="n">nthreads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">         </span><span class="n">max_mem_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;24g&quot;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="p">)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c1">## Sending file to h2o</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="n">train_h2o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feature_matrix_wide</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Diff&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">Winner</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">  </span><span class="nf">as.h2o</span><span class="p">(</span><span class="n">destination_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;train_h2o&quot;</span><span class="p">)</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="n">aus_open_2019_features_h2o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aus_open_2019_features</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="s">&quot;Diff&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">  </span><span class="nf">as.h2o</span><span class="p">(</span><span class="n">destination_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;aus_open_2019_features_h2o&quot;</span><span class="p">)</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c1">## Running Auto ML </span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="n">mens_model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">h2o.automl</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Winner&quot;</span><span class="p">,</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">                        </span><span class="n">training_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_h2o</span><span class="p">,</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">                        </span><span class="n">max_runtime_secs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">                        </span><span class="n">max_models</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">                        </span><span class="n">stopping_metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;logloss&quot;</span><span class="p">,</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">                        </span><span class="n">sort_metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;logloss&quot;</span><span class="p">,</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">                        </span><span class="n">balance_classes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">                        </span><span class="n">seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">183</span><span class="p">)</span><span class="w"> </span><span class="c1"># Set seed to replicate results - 183 is the most games played in a tennis match (Isner-Mahut)</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="c1">## Predictions on test frame</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="n">predictions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">h2o.predict</span><span class="p">(</span><span class="n">mens_model</span><span class="o">@</span><span class="n">leader</span><span class="p">,</span><span class="w"> </span><span class="n">aus_open_2019_features_h2o</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">  </span><span class="nf">as.data.frame</span><span class="p">()</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="n">aus_open_2019_features</span><span class="o">$</span><span class="n">prob_player_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predictions</span><span class="o">$</span><span class="n">p1</span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="n">aus_open_2019_features</span><span class="o">$</span><span class="n">prob_player_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predictions</span><span class="o">$</span><span class="n">p0</span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="nf">h2o.shutdown</span><span class="p">(</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</code></pre></div>
Now let's find the best player by taking the mean of the prediction probability by player.
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">aus_open_2019_features</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">player_1</span><span class="p">,</span><span class="w"> </span><span class="nf">starts_with</span><span class="p">(</span><span class="s">&quot;F_&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">prob_player_1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">player_1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">  </span><span class="nf">summarise_all</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">  </span><span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">prob_player_1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="nf">datatable</span><span class="p">(</span><span class="n">rownames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Scroller&#39;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">            </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">dom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t&quot;</span><span class="p">,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">                          </span><span class="n">scrollY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">450</span><span class="p">,</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">                          </span><span class="n">scroller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">                          </span><span class="n">scrollX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">,</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">                          </span><span class="n">fixedColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">  </span><span class="nf">formatRound</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nf">pluck</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</code></pre></div></p>
<table>
<thead>
<tr>
<th>player_1</th>
<th>F_Serve_Win_Ratio_Diff</th>
<th>F_Return_Win_Ratio_Diff</th>
<th>F_Game_Win_Percentage_Diff</th>
<th>F_BreakPoints_Per_Game_Diff</th>
<th>F_Rank_Diff</th>
<th>prob_player_1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Novak Djokovic</td>
<td>0.1109364627</td>
<td>0.076150615</td>
<td>0.1483970690</td>
<td>0.17144300</td>
<td>NA</td>
<td>0.8616486</td>
</tr>
<tr>
<td>Karen Khachanov</td>
<td>0.0960639298</td>
<td>0.061436164</td>
<td>0.1059967623</td>
<td>0.04544955</td>
<td>NA</td>
<td>0.8339594</td>
</tr>
<tr>
<td>Juan Martin del Potro</td>
<td>0.1003931993</td>
<td>0.042025222</td>
<td>0.0847985439</td>
<td>0.05943767</td>
<td>NA</td>
<td>0.8218308</td>
</tr>
<tr>
<td>Rafael Nadal</td>
<td>0.0480432305</td>
<td>0.051531252</td>
<td>0.0790179917</td>
<td>0.08181694</td>
<td>NA</td>
<td>0.8032543</td>
</tr>
<tr>
<td>Gilles Simon</td>
<td>0.0646937767</td>
<td>0.084843307</td>
<td>0.0901401318</td>
<td>0.08675350</td>
<td>NA</td>
<td>0.7985995</td>
</tr>
<tr>
<td>Roger Federer</td>
<td>0.0452014997</td>
<td>0.040992497</td>
<td>0.0725719954</td>
<td>0.01817046</td>
<td>NA</td>
<td>0.7962289</td>
</tr>
<tr>
<td>Kei Nishikori</td>
<td>0.0777155934</td>
<td>0.018720226</td>
<td>0.0800648870</td>
<td>0.02740276</td>
<td>NA</td>
<td>0.7843631</td>
</tr>
<tr>
<td>Marin Cilic</td>
<td>0.0285413602</td>
<td>0.053017465</td>
<td>0.0736687072</td>
<td>0.08883055</td>
<td>NA</td>
<td>0.7804876</td>
</tr>
<tr>
<td>Tomas Berdych</td>
<td>0.0471654691</td>
<td>0.047289449</td>
<td>0.0737401748</td>
<td>0.10584114</td>
<td>NA</td>
<td>0.7739211</td>
</tr>
<tr>
<td>Daniil Medvedev</td>
<td>0.0275430665</td>
<td>0.031121856</td>
<td>0.0721948279</td>
<td>0.01803757</td>
<td>NA</td>
<td>0.7543269</td>
</tr>
<tr>
<td>Stefanos Tsitsipas</td>
<td>0.0470382377</td>
<td>0.023825850</td>
<td>0.0577628626</td>
<td>0.02105227</td>
<td>NA</td>
<td>0.7511674</td>
</tr>
<tr>
<td>Dominic Thiem</td>
<td>0.0258904189</td>
<td>0.032481624</td>
<td>0.0483707080</td>
<td>0.05857158</td>
<td>NA</td>
<td>0.7451547</td>
</tr>
<tr>
<td>Alexander Zverev</td>
<td>0.0006199716</td>
<td>0.044811275</td>
<td>0.0380134371</td>
<td>0.08423392</td>
<td>NA</td>
<td>0.7374897</td>
</tr>
<tr>
<td>Kyle Edmund</td>
<td>0.0558006240</td>
<td>0.011963627</td>
<td>0.0478850676</td>
<td>0.05142186</td>
<td>NA</td>
<td>0.7304873</td>
</tr>
<tr>
<td>Pablo Carreno Busta</td>
<td>0.0321878318</td>
<td>0.029862068</td>
<td>0.0413674481</td>
<td>-0.00229784</td>
<td>NA</td>
<td>0.7302043</td>
</tr>
<tr>
<td>Borna Coric</td>
<td>0.0762084129</td>
<td>-0.010097922</td>
<td>0.0413621283</td>
<td>-0.01924267</td>
<td>NA</td>
<td>0.7268124</td>
</tr>
<tr>
<td>Kevin Anderson</td>
<td>0.0907358428</td>
<td>-0.027171681</td>
<td>0.0381421997</td>
<td>-0.06362578</td>
<td>NA</td>
<td>0.7260799</td>
</tr>
<tr>
<td>David Goffin</td>
<td>-0.0034821911</td>
<td>0.037247336</td>
<td>0.0162572061</td>
<td>0.05603565</td>
<td>NA</td>
<td>0.7155908</td>
</tr>
<tr>
<td>Fernando Verdasco</td>
<td>0.0229261365</td>
<td>0.032884054</td>
<td>0.0521212576</td>
<td>0.04668854</td>
<td>NA</td>
<td>0.7120831</td>
</tr>
<tr>
<td>Roberto Bautista Agut</td>
<td>0.0047641170</td>
<td>0.049939608</td>
<td>0.0218975349</td>
<td>0.07331023</td>
<td>NA</td>
<td>0.7009891</td>
</tr>
<tr>
<td>Milos Raonic</td>
<td>0.0849726089</td>
<td>-0.028732182</td>
<td>0.0385944327</td>
<td>-0.08009382</td>
<td>NA</td>
<td>0.6986865</td>
</tr>
<tr>
<td>Fabio Fognini</td>
<td>-0.0394792678</td>
<td>0.047935185</td>
<td>0.0226546894</td>
<td>0.06213496</td>
<td>NA</td>
<td>0.6982031</td>
</tr>
<tr>
<td>Hyeon Chung</td>
<td>0.0042489153</td>
<td>0.047722133</td>
<td>0.0158096386</td>
<td>0.04823304</td>
<td>NA</td>
<td>0.6958943</td>
</tr>
<tr>
<td>Jack Sock</td>
<td>-0.0099659903</td>
<td>0.026454984</td>
<td>0.0186547428</td>
<td>0.02307214</td>
<td>NA</td>
<td>0.6757770</td>
</tr>
<tr>
<td>Diego Schwartzman</td>
<td>-0.0317130675</td>
<td>0.032098381</td>
<td>0.0006215006</td>
<td>0.05621187</td>
<td>NA</td>
<td>0.6631067</td>
</tr>
<tr>
<td>John Millman</td>
<td>0.0016290285</td>
<td>0.042676556</td>
<td>0.0119857356</td>
<td>0.06228135</td>
<td>NA</td>
<td>0.6603912</td>
</tr>
<tr>
<td>Nikoloz Basilashvili</td>
<td>-0.0099968609</td>
<td>0.005561102</td>
<td>0.0473876170</td>
<td>0.03661962</td>
<td>NA</td>
<td>0.6602628</td>
</tr>
<tr>
<td>John Isner</td>
<td>0.1346946527</td>
<td>-0.070556940</td>
<td>0.0161348609</td>
<td>-0.11425009</td>
<td>NA</td>
<td>0.6598097</td>
</tr>
<tr>
<td>Gael Monfils</td>
<td>-0.0074254934</td>
<td>0.024286746</td>
<td>0.0295568649</td>
<td>0.04007519</td>
<td>NA</td>
<td>0.6449506</td>
</tr>
<tr>
<td>Richard Gasquet</td>
<td>0.0296009556</td>
<td>-0.011382437</td>
<td>0.0013138324</td>
<td>-0.03972967</td>
<td>NA</td>
<td>0.6442043</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>Laslo Djere</td>
<td>-0.042300822</td>
<td>-0.0150684095</td>
<td>-0.064667709</td>
<td>-0.0349151578</td>
<td>NA</td>
<td>0.3606923</td>
</tr>
<tr>
<td>David Ferrer</td>
<td>-0.036179509</td>
<td>0.0532782117</td>
<td>0.012751020</td>
<td>0.0914824480</td>
<td>NA</td>
<td>0.3488057</td>
</tr>
<tr>
<td>Bradley Klahn</td>
<td>-0.001248083</td>
<td>-0.0444982448</td>
<td>-0.025987040</td>
<td>-0.1181295700</td>
<td>NA</td>
<td>0.3487806</td>
</tr>
<tr>
<td>Marcel Granollers</td>
<td>-0.031011830</td>
<td>-0.0094056152</td>
<td>-0.049853664</td>
<td>0.0136841358</td>
<td>NA</td>
<td>0.3460035</td>
</tr>
<tr>
<td>Ricardas Berankis</td>
<td>-0.022557215</td>
<td>-0.0103782963</td>
<td>-0.047937290</td>
<td>-0.0468488990</td>
<td>NA</td>
<td>0.3454980</td>
</tr>
<tr>
<td>Radu Albot</td>
<td>-0.040829057</td>
<td>0.0076150564</td>
<td>-0.034891704</td>
<td>0.0443672533</td>
<td>NA</td>
<td>0.3420615</td>
</tr>
<tr>
<td>Jordan Thompson</td>
<td>-0.068554906</td>
<td>0.0261969117</td>
<td>-0.044349181</td>
<td>0.0206636045</td>
<td>NA</td>
<td>0.3358572</td>
</tr>
<tr>
<td>Thomas Fabbiano</td>
<td>-0.060583307</td>
<td>0.0275756029</td>
<td>-0.025883493</td>
<td>0.0709707306</td>
<td>NA</td>
<td>0.3319778</td>
</tr>
<tr>
<td>Roberto Carballes Baena</td>
<td>-0.054016396</td>
<td>-0.0091521177</td>
<td>-0.019093050</td>
<td>0.0347187874</td>
<td>NA</td>
<td>0.3312105</td>
</tr>
<tr>
<td>Paolo Lorenzi</td>
<td>-0.038613500</td>
<td>-0.0212206827</td>
<td>-0.052602703</td>
<td>0.0199474025</td>
<td>NA</td>
<td>0.3299791</td>
</tr>
<tr>
<td>Guido Andreozzi</td>
<td>-0.038614385</td>
<td>-0.0133763922</td>
<td>0.029549861</td>
<td>0.0636745661</td>
<td>NA</td>
<td>0.3288762</td>
</tr>
<tr>
<td>Peter Polansky</td>
<td>0.007461636</td>
<td>-0.0163389196</td>
<td>-0.024034159</td>
<td>-0.0442144260</td>
<td>NA</td>
<td>0.3216756</td>
</tr>
<tr>
<td>Ernests Gulbis</td>
<td>-0.062827089</td>
<td>-0.0134699552</td>
<td>-0.027633425</td>
<td>-0.0518663252</td>
<td>NA</td>
<td>0.3123511</td>
</tr>
<tr>
<td>Thiago Monteiro</td>
<td>0.001235931</td>
<td>-0.0288349103</td>
<td>-0.043831840</td>
<td>-0.0654744344</td>
<td>NA</td>
<td>0.3122069</td>
</tr>
<tr>
<td>Casper Ruud</td>
<td>0.016838968</td>
<td>-0.0178511679</td>
<td>0.015234507</td>
<td>0.0219131874</td>
<td>NA</td>
<td>0.3119321</td>
</tr>
<tr>
<td>Marco Trungelliti</td>
<td>-0.022148774</td>
<td>-0.0005658242</td>
<td>0.048542554</td>
<td>0.1243537739</td>
<td>NA</td>
<td>0.3092636</td>
</tr>
<tr>
<td>Jiri Vesely</td>
<td>-0.050204009</td>
<td>-0.0351868278</td>
<td>-0.042887646</td>
<td>-0.0160467165</td>
<td>NA</td>
<td>0.3089287</td>
</tr>
<tr>
<td>Guillermo Garcia-Lopez</td>
<td>-0.090076100</td>
<td>-0.0108663630</td>
<td>-0.048712763</td>
<td>-0.0124446402</td>
<td>NA</td>
<td>0.3080898</td>
</tr>
<tr>
<td>Michael Mmoh</td>
<td>-0.063802934</td>
<td>-0.0079053251</td>
<td>-0.011112236</td>
<td>-0.0332042032</td>
<td>NA</td>
<td>0.2822330</td>
</tr>
<tr>
<td>Jason Kubler</td>
<td>-0.124758873</td>
<td>-0.0202756806</td>
<td>-0.013998570</td>
<td>0.1020895301</td>
<td>NA</td>
<td>0.2814246</td>
</tr>
<tr>
<td>Ruben Bemelmans</td>
<td>-0.029036164</td>
<td>-0.0138846550</td>
<td>-0.032256254</td>
<td>-0.0363563402</td>
<td>NA</td>
<td>0.2772185</td>
</tr>
<tr>
<td>Bjorn Fratangelo</td>
<td>-0.014149222</td>
<td>0.0033574304</td>
<td>-0.019931504</td>
<td>-0.0360199607</td>
<td>NA</td>
<td>0.2652527</td>
</tr>
<tr>
<td>Pablo Andujar</td>
<td>-0.042869833</td>
<td>-0.0488261697</td>
<td>-0.070057834</td>
<td>-0.0164918910</td>
<td>NA</td>
<td>0.2647100</td>
</tr>
<tr>
<td>Christian Garin</td>
<td>-0.046150875</td>
<td>0.0235799476</td>
<td>-0.006209664</td>
<td>0.0736304057</td>
<td>NA</td>
<td>0.2631607</td>
</tr>
<tr>
<td>Ivo Karlovic</td>
<td>0.071597162</td>
<td>-0.1093833837</td>
<td>0.001410787</td>
<td>-0.1237762218</td>
<td>NA</td>
<td>0.2500242</td>
</tr>
<tr>
<td>Juan Ignacio Londero</td>
<td>-0.026454456</td>
<td>-0.0715665271</td>
<td>-0.016749898</td>
<td>-0.0363353678</td>
<td>NA</td>
<td>0.2351747</td>
</tr>
<tr>
<td>Ramkumar Ramanathan</td>
<td>-0.005371622</td>
<td>-0.0606138479</td>
<td>-0.041631884</td>
<td>-0.0005573405</td>
<td>NA</td>
<td>0.2272977</td>
</tr>
<tr>
<td>Reilly Opelka</td>
<td>0.025704824</td>
<td>-0.0607219257</td>
<td>-0.015474944</td>
<td>-0.0720809006</td>
<td>NA</td>
<td>0.2262993</td>
</tr>
<tr>
<td>Carlos Berlocq</td>
<td>-0.063580460</td>
<td>0.0074576369</td>
<td>-0.054277974</td>
<td>-0.0165235079</td>
<td>NA</td>
<td>0.2112275</td>
</tr>
<tr>
<td>Pedro Sousa</td>
<td>-0.197333352</td>
<td>-0.0734557562</td>
<td>-0.161962722</td>
<td>-0.1023311674</td>
<td>NA</td>
<td>0.1502313</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="disclaimer">Disclaimer</h3>
<p>Note that whilst models and automated strategies are fun and rewarding to create, we can't promise that your model or betting strategy will be profitable, and we make no representations in relation to the code shared or information on this page. If you're using this code or implementing your own strategies, you do so entirely at your own risk and you are responsible for any winnings/losses incurred. Under no circumstances will Betfair be liable for any loss or damage you suffer.</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
    
      <nav class="md-footer__inner md-grid" aria-label="footer.title">
        
          
          <a href="../howToModelTheAusOpen/" class="md-footer__link md-footer__link--prev" aria-label="Previous: How to model the Australian Open" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                How to model the Australian Open
              </div>
            </div>
          </a>
        
        
          
          <a href="../AusOpenPythonTutorial/" class="md-footer__link md-footer__link--next" aria-label="Next: Aus Open Python Tutorial" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                Aus Open Python Tutorial
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-copyright">
  
  
</div>
        
          <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/Betfair_Aus" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/company/betfair-australia" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://facebook.com/betfairaustralia" target="_blank" rel="noopener" title="facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/user/betfairaus" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/betfair-datascientists" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
        
      </div>

      <div class="bf-footer">
          <div class="bf-footer-inner">
              <p class="bf-light">Betfair Pty Limited is licensed and regulated by the Northern Territory Government of Australia.</p>
              <p class="bf-dark">Betfair Pty Limited's gambling operations are governed by its <a class='inner-link' href="https://www.betfair.com.au/info/responsible-gambling/">Responsible Gambling Code of Conduct</a> and for South
              Australian residents by the <a class='inner-link' href="https://www.betfair.com.au/info/pdf/SA-GCoP.pdf">South Australian Responsible Gambling Code of Practice.</a></p>
              <!-- BetStop block in white box -->
              <div class="full-screen">
                  <p style="font-family: Arial, sans-serif; font-size: 1.2rem; font-weight: bold; text-align: center;">
                    BetStop is the Australian National Self-Exclusion Register. For more information, please visit 
                    <a href="https://betstop.gov.au" style="font-family: Arial, sans-serif; font-size: 1.2rem; font-weight: bold; color: black; text-decoration: none;">
                      https://betstop.gov.au
                    </a>
                  </p>
              </div>
              <br />
              <!-- RG footer block -->
              <div class="full-screen"> <p style="font-family: Arial, sans-serif; font-size: 1.2rem; font-weight: bold; text-align: center;">Imagine what you could be buying instead.</p> <p style="font-family: Arial, sans-serif; font-size: 0.8rem; font-weight: bold; text-align: center;">For free and confidential support call 1800 858 858 or visit <a href="http://www.gamblinghelponline.org.au" style="color: black; text-decoration: underline;">gamblinghelponline.org.au</a></p> </div>
              <ul class="bf-links">
                <li><a href="https://www.betfair.com.au/hub/help/account-help/responsible-gambling/">Responsible Gambling</a><span>|</span></li>
                <li><a href="http://www.betfair.com/AUS_NZL/aboutUs/Terms.and.Conditions/">Terms & Conditions</a><span>|</span></li>
                <li><a href="https://www.betfair.com.au/info/privacy-policy/">Privacy Policy</a><span>|</span></li>
                <li><a href="http://www.betfair.com/en/aboutUs/Rules.and.Regulations/">Rules & Regulations</a><span>|</span></li>
                <li><a href="https://www.betfair.com/AUS_NZL/aboutUs/Dispute.Resolution">Dispute Resolution</a></li>
              </ul>
          </div>
      </div>
    </div>

    <script src="https://js.adsrvr.org/up_loader.1.1.0.js" type="text/javascript"></script>
    <script type="text/javascript">
        ttd_dom_ready( function() {
            if (typeof TTDUniversalPixelApi === 'function') {
                var universalPixelApi = new TTDUniversalPixelApi();
                universalPixelApi.init("y12d1ir", ["8ml4f17"], "https://insight.adsrvr.org/track/up");
            }
        });
    </script>

</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "navigation.instant", "navigation.tabs", "navigation.top", "navigation.expand", "navigation.sections", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../js/scripts.js"></script>
      
    
  </body>
</html>