
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation, guides and articles on creating, developing and implementing automated betting strategies, using data analysis to inform betting models and how to interact with the Betfair API.">
      
      
        <meta name="author" content="Betfair Data Scientists">
      
      
        <link rel="canonical" href="https://betfair-datascientists.github.io/modelling/brownlowModelTutorial/">
      
      <link rel="icon" href="../../img/BetfairFavicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>Modelling the Brownlow Medal in Python - The Automation Hub</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/betfair.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modelling-the-brownlow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      
  
  <header class="md-header" data-md-component="header">
    <nav class="md-header__inner md-grid" aria-label="Header">
      <a href="../.." title="The Automation Hub" class="md-header__button md-logo" aria-label="The Automation Hub" data-md-component="logo">
        
  <img src="../../img/logo.svg" alt="logo">

      </a>
      <label class="md-header__button md-icon" for="__drawer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
      </label>
      <div class="md-header__title" data-md-component="header-title">
        <div class="md-header__ellipsis">
          <div class="md-header__topic">
            <span class="md-ellipsis">
              The Automation Hub
            </span>
          </div>
          <div class="md-header__topic" data-md-component="header-topic">
            <span class="md-ellipsis">
              
                Modelling the Brownlow Medal in Python
              
            </span>
          </div>
        </div>
      </div>
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
              </label>
            
          
        </form>
      
      
      
        <label class="md-header__button md-icon" for="__search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
      
    </nav>
    
  </header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Automation Hub" class="md-nav__button md-logo" aria-label="The Automation Hub" data-md-component="logo">
      
  <img src="../../img/logo.svg" alt="logo">

    </a>
    The Automation Hub
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        The Automation Hub
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiResources/" class="md-nav__link">
        API resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiappkey/" class="md-nav__link">
        How to access the Betfair API
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiRtutorial/" class="md-nav__link">
        API tutorials in R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/apiPythontutorial/" class="md-nav__link">
        API tutorial in Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/GoldenRulesofAutomation/" class="md-nav__link">
        Golden rules of automation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Historic Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Historic Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Historic Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../historicData/dataSources/" class="md-nav__link">
        Pricing Data Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../historicData/jsonToCsvTutorial/" class="md-nav__link">
        JSON to CSV in Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../historicData/backtestingRatingsTutorial/" class="md-nav__link">
        Back testing ratings in Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Historic Data site
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Historic Data site" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Historic Data site
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../historicData/usingHistoricDataSite/" class="md-nav__link">
        Downloading from the Historic Data site
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Modelling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modelling" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Modelling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../howToModel/" class="md-nav__link">
        Intro to modelling
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Soccer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Soccer" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Soccer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../soccerEloTutorialR/" class="md-nav__link">
        Elo soccer tutorial in R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../soccerModellingTutorialPython/" class="md-nav__link">
        Soccer modelling tutorial in Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../soccerModellingTutorialR/" class="md-nav__link">
        Soccer modelling tutorial in R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EPLmlPython/" class="md-nav__link">
        EPL ML walk through in Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          AFL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AFL" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          AFL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AFLmodellingPython/" class="md-nav__link">
        AFL modelling walk through in Python
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Modelling the Brownlow Medal in Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Modelling the Brownlow Medal in Python
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#eda-read-in-the-data" class="md-nav__link">
    EDA - Read in the data
  </a>
  
    <nav class="md-nav" aria-label="EDA - Read in the data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploring-votes-if-a-bag-is-kicked-5-goals" class="md-nav__link">
    Exploring votes if a bag is kicked (5+ goals)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploring-votes-if-the-player-has-30-possies-2-goals" class="md-nav__link">
    Exploring votes if the player has 30+ possies &amp; 2+ goals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-is-player-captain-feature" class="md-nav__link">
    Create Is Player Captain Feature
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Tennis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tennis" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Tennis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../howToModelTheAusOpen/" class="md-nav__link">
        How to model the Australian Open
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AusOpenRTutorial/" class="md-nav__link">
        Aus Open R Tutorial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AusOpenPythonTutorial/" class="md-nav__link">
        Aus Open Python Tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Auto Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Auto Tools" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Auto Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/overview/" class="md-nav__link">
        Tools Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Bet Angel
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Bet Angel" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Bet Angel
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngel/betAngel/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelbeginners/" class="md-nav__link">
        Beginner's guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelintermediate/" class="md-nav__link">
        Intermediate guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngeladvanced/" class="md-nav__link">
        Advanced guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelRatingsAutomation/" class="md-nav__link">
        Ratings auto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelMarketFavouriteAutomation/" class="md-nav__link">
        Market fav auto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelTippingAutomation/" class="md-nav__link">
        Tipping auto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelSimultaneousMarkets/" class="md-nav__link">
        Simultaneous markets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/betAngelKellyStake/" class="md-nav__link">
        Kelly criterion staking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Gruss Betting Assistant
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Gruss Betting Assistant" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Gruss Betting Assistant
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/Gruss/Gruss/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/GrussSettingupbasicmarketview/" class="md-nav__link">
        Setup basic market view and one click betting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/grussRatingsAutomation/" class="md-nav__link">
        Ratings auto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/grussMarketFavouriteAutomation/" class="md-nav__link">
        Market fav auto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/grusslSimultaneousMarkets/" class="md-nav__link">
        Simultaneous markets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/grussKellyStake/" class="md-nav__link">
        Kelly criterion staking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_4">
          Cymatic Trader
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cymatic Trader" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Cymatic Trader
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/CymaticTrader/CymaticTrader/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/cymaticTraderRatingsAutomation/" class="md-nav__link">
        Ratings auto
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" type="checkbox" id="__nav_5_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_5">
          Geeks Toy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Geeks Toy" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_5">
          <span class="md-nav__icon md-icon"></span>
          Geeks Toy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/GeeksToyinstallationandsetup/" class="md-nav__link">
        Installation and setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/GeeksToybasicmarketviewstakingandoneclickbetting/" class="md-nav__link">
        Setup basic market view and one click betting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoTools/geeksToyRefreshSettings/" class="md-nav__link">
        Optimising refresh settings
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#eda-read-in-the-data" class="md-nav__link">
    EDA - Read in the data
  </a>
  
    <nav class="md-nav" aria-label="EDA - Read in the data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploring-votes-if-a-bag-is-kicked-5-goals" class="md-nav__link">
    Exploring votes if a bag is kicked (5+ goals)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploring-votes-if-the-player-has-30-possies-2-goals" class="md-nav__link">
    Exploring votes if the player has 30+ possies &amp; 2+ goals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-is-player-captain-feature" class="md-nav__link">
    Create Is Player Captain Feature
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="modelling-the-brownlow">Modelling the Brownlow</h1>
<p>This walkthrough will provide a brief, yet effective tutorial on how to model the Brownlow medal. We will use data from 2010 to 2018, which includes Supercoach points and other useful stats.</p>
<p>The output will be the number of votes predicted for each player in each match, and we will aggregate these to create aggregates for each team and for the whole competition. No doubt we'll have Mitchell right up the top, and if we don't, then we know we've done something wrong!</p>
<pre><code class="language-python"># Import modules libraries
import pandas as pd
import h2o
from h2o.automl import H2OAutoML
import numpy as np
from sklearn.preprocessing import StandardScaler
import os
import pickle

# Change notebook settings
pd.options.display.max_columns = None
pd.options.display.max_rows = 300
from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity = &quot;all&quot;
</code></pre>
<hr />
<h2 id="eda-read-in-the-data">EDA - Read in the data</h2>
<p>I have collated this data using the fitzRoy R package and merging the afltables dataset with the footywire dataset, so that we can Supercoach and other advanced stats with Brownlow votes. Let's read in the data and have a sneak peak at what it looks like.</p>
<pre><code class="language-python">brownlow_data = pd.read_csv('data/afl_brownlow_data.csv')

brownlow_data.tail(3)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>date</th>
<th>season</th>
<th>round</th>
<th>venue</th>
<th>ID</th>
<th>match_id</th>
<th>player</th>
<th>jumper_no</th>
<th>team</th>
<th>opposition</th>
<th>status</th>
<th>team_score</th>
<th>opposition_score</th>
<th>margin</th>
<th>brownlow_votes</th>
<th>CP</th>
<th>UP</th>
<th>ED</th>
<th>DE</th>
<th>CM</th>
<th>GA</th>
<th>MI5</th>
<th>one_perc</th>
<th>BO</th>
<th>TOG</th>
<th>K</th>
<th>HB</th>
<th>D</th>
<th>M</th>
<th>G</th>
<th>B</th>
<th>T</th>
<th>HO</th>
<th>I50</th>
<th>CL</th>
<th>CG</th>
<th>R50</th>
<th>FF</th>
<th>FA</th>
<th>AF</th>
<th>SC</th>
</tr>
</thead>
<tbody>
<tr>
<td>76585</td>
<td>2018-08-26</td>
<td>2018</td>
<td>23</td>
<td>Etihad Stadium</td>
<td>12312</td>
<td>9708.0</td>
<td>M Wood</td>
<td>32</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>Away</td>
<td>117</td>
<td>94</td>
<td>23</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2</td>
<td>66.7</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>34</td>
<td>3</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>24</td>
<td>25</td>
</tr>
<tr>
<td>76586</td>
<td>2018-08-26</td>
<td>2018</td>
<td>23</td>
<td>Etihad Stadium</td>
<td>11755</td>
<td>9708.0</td>
<td>S Wright</td>
<td>19</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>Away</td>
<td>117</td>
<td>94</td>
<td>23</td>
<td>NaN</td>
<td>10</td>
<td>17</td>
<td>22</td>
<td>75.9</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>83</td>
<td>16</td>
<td>13</td>
<td>29</td>
<td>8</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>107</td>
<td>96</td>
</tr>
<tr>
<td>76587</td>
<td>2018-08-26</td>
<td>2018</td>
<td>23</td>
<td>Etihad Stadium</td>
<td>11724</td>
<td>9708.0</td>
<td>J Ziebell</td>
<td>7</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>Away</td>
<td>117</td>
<td>94</td>
<td>23</td>
<td>NaN</td>
<td>9</td>
<td>8</td>
<td>11</td>
<td>73.3</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>94</td>
<td>12</td>
<td>3</td>
<td>15</td>
<td>6</td>
<td>3</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>89</td>
<td>109</td>
</tr>
</tbody>
</table>
<p>It looks like we've got about 76,000 rows of data and have stats like hitouts, clangers, effective disposals etc. Let's explore some certain scenarios. Using my domain knowledge of footy, I can hypothesise that if a player kicks 5 goals, he is pretty likely to poll votes. Similarly, if a player gets 30 possessions and 2+ goals, he is also probably likely to poll votes. Let's have a look at the mean votes for players for both of these situations. </p>
<h3 id="exploring-votes-if-a-bag-is-kicked-5-goals">Exploring votes if a bag is kicked (5+ goals)</h3>
<pre><code class="language-python">brownlow_data.query('G &gt;= 5').groupby('season').brownlow_votes.mean()
print(&quot;Mean votes is a player has kicked a bag:&quot;, brownlow_data.query('G &gt;= 5').brownlow_votes.mean())

    season
    2010    1.420455
    2011    1.313433
    2012    1.413333
    2013    1.253731
    2014    1.915254
    2015    1.765625
    2016    1.788732
    2017    2.098361
    2018    0.000000
    Name: brownlow_votes, dtype: float64

    Mean votes is a player has kicked a bag: 1.4708818635607321
</code></pre>
<h3 id="exploring-votes-if-the-player-has-30-possies-2-goals">Exploring votes if the player has 30+ possies &amp; 2+ goals</h3>
<pre><code class="language-python">brownlow_data.query('G &gt;= 2 and D &gt;= 30').groupby('season').brownlow_votes.mean()
print(&quot;Mean votes if a player has 30 possies and kicks 2+ goals:&quot;, brownlow_data.query('G &gt;= 2 and D &gt;= 30').brownlow_votes.mean())

    season
    2010    1.826923
    2011    1.756410
    2012    2.118421
    2013    2.000000
    2014    2.253731
    2015    2.047619
    2016    2.103448
    2017    2.050000
    2018    0.000000
    Name: brownlow_votes, dtype: float64

    Mean votes if a player has 30 possies and kicks 2+ goals: 1.8741379310344828
</code></pre>
<p>As suspected, the average votes for these two situations is 1.87! That's huge. Let's get an idea of the average votes for each player. It should be around 6/44, as there are always 6 votes per match and around 44 players per match.</p>
<pre><code class="language-python">brownlow_data.brownlow_votes.mean()
    0.12347341475121326
</code></pre>
<p>So the average vote is 0.12. Let's see how this changes is the player is a captain. I have collected data on if players are captains from wikipedia and collated it into a csv. Let's load this in and create a "Is the player captain" feature, then check the average votes for captains.</p>
<h3 id="create-is-player-captain-feature">Create Is Player Captain Feature</h3>
<pre><code class="language-python">captains = pd.read_csv('data/captains.csv').set_index('player')

def is_captain_for_that_season(captains_df, player, year):

    if player in captains_df.index:
        # Get years they were captain
        seasons = captains_df.loc[player].season.split('-')
        if len(seasons) == 1:
            seasons_captain = list(map(int, seasons))
        elif len(seasons) == 2:
            if seasons[1] == '':
                seasons_captain = list(range(int(seasons[0]), 2019))
            else:
                seasons_captain = list(range(int(seasons[0]), int(seasons[1]) + 1))

        if year in seasons_captain:
            return 1
    return 0

brownlow_data['is_captain'] = brownlow_data.apply(lambda x: is_captain_for_that_season(captains, x.player, x.season), axis='columns')
</code></pre>
<pre><code class="language-python">brownlow_data.query('is_captain == 1').groupby('season').brownlow_votes.mean()
print(&quot;Mean votes if a player is captain:&quot;, brownlow_data.query('is_captain == 1').brownlow_votes.mean())

    season
    2010    0.408497
    2011    0.429936
    2012    0.274194
    2013    0.438725
    2014    0.519663
    2015    0.447222
    2016    0.347826
    2017    0.425806
    2018    0.000000
    Name: brownlow_votes, dtype: float64

    Mean votes if a player is captain: 0.36661698956780925
</code></pre>
<p>This is significantly higher than if they aren't captain. What would be interesting is to look at the average difference in votes between when they were captain and when they weren't, to try and find if there is a 'captain bias' in brownlow votes. Go ahead and try. For now, we're going to move onto feature creation</p>
<hr />
<h1 id="feature-creation">Feature Creation</h1>
<p>Let's make a range of features, including:</p>
<ul>
<li>Ratios of each statistic per game</li>
<li>If the player is a captain</li>
<li>If they kicked a bag (4/5+)</li>
<li>If they kicked 2 and had 30+ possies</li>
</ul>
<p>First we will make features of ratios. What is important is not how many of a certain stat a player has, but how much of that stat a player has <em>relative</em> to everyone else in the same match. It doesn't matter if Dusty Martin has 31 possessions if Tom Mitchell has had 50 - Mitchell is probably more likely to poll (assuming all else is equal). So rather than using the actual number of possessions for example, we can divide these possessions by the total amount of possessions in the game. To do this we'll use pandas groupby and transform methods.</p>
<h3 id="create-ratios-as-features">Create Ratios As Features</h3>
<pre><code class="language-python">%%time

# Get a list of stats of which to create ratios for
ratio_cols = ['CP', 'UP', 'ED', 'DE', 'CM', 'GA', 'MI5', 'one_perc', 'BO', 'TOG', 
               'K', 'HB', 'D', 'M', 'G', 'B', 'T', 'HO', 'I50', 'CL', 'CG', 'R50', 
               'FF', 'FA', 'AF', 'SC']

# Create a ratios df
ratios = (brownlow_data.copy()
          .loc[:, ['match_id'] + ratio_cols]
          .groupby('match_id')
          .transform(lambda x: x / x.sum()))

feature_cols = ['date', 'season', 'round', 'venue', 'ID', 'match_id', 'player', 'jumper_no', 'team', 
                'opposition', 'status', 'team_score', 'opposition_score', 'margin', 'brownlow_votes']

# Create a features df - join the ratios to this df
features = (brownlow_data[feature_cols].copy()
               .join(ratios))

    Wall time: 11.3 s
</code></pre>
<pre><code class="language-python">features.head()
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>date</th>
<th>season</th>
<th>round</th>
<th>venue</th>
<th>ID</th>
<th>match_id</th>
<th>player</th>
<th>jumper_no</th>
<th>team</th>
<th>opposition</th>
<th>status</th>
<th>team_score</th>
<th>opposition_score</th>
<th>margin</th>
<th>brownlow_votes</th>
<th>CP</th>
<th>UP</th>
<th>ED</th>
<th>DE</th>
<th>CM</th>
<th>GA</th>
<th>MI5</th>
<th>one_perc</th>
<th>BO</th>
<th>TOG</th>
<th>K</th>
<th>HB</th>
<th>D</th>
<th>M</th>
<th>G</th>
<th>B</th>
<th>T</th>
<th>HO</th>
<th>I50</th>
<th>CL</th>
<th>CG</th>
<th>R50</th>
<th>FF</th>
<th>FA</th>
<th>AF</th>
<th>SC</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>2010-03-28</td>
<td>2010</td>
<td>1</td>
<td>Domain Stadium</td>
<td>11807</td>
<td>5096.0</td>
<td>T Armstrong</td>
<td>38</td>
<td>Adelaide</td>
<td>Fremantle</td>
<td>Away</td>
<td>62</td>
<td>118</td>
<td>-56</td>
<td>0.0</td>
<td>0.013393</td>
<td>0.016304</td>
<td>0.015517</td>
<td>0.025529</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.013333</td>
<td>0.000000</td>
<td>0.020516</td>
<td>0.013441</td>
<td>0.014599</td>
<td>0.014049</td>
<td>0.022599</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.011494</td>
<td>0.000000</td>
<td>0.036145</td>
<td>0.018868</td>
<td>0.000000</td>
<td>0.037037</td>
<td>0.011568</td>
<td>0.005456</td>
</tr>
<tr>
<td>1</td>
<td>2010-03-28</td>
<td>2010</td>
<td>1</td>
<td>Domain Stadium</td>
<td>3968</td>
<td>5096.0</td>
<td>N Bock</td>
<td>44</td>
<td>Adelaide</td>
<td>Fremantle</td>
<td>Away</td>
<td>62</td>
<td>118</td>
<td>-56</td>
<td>0.0</td>
<td>0.008929</td>
<td>0.025362</td>
<td>0.022414</td>
<td>0.023875</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.080000</td>
<td>0.000000</td>
<td>0.027169</td>
<td>0.032258</td>
<td>0.012165</td>
<td>0.021711</td>
<td>0.016949</td>
<td>0.038462</td>
<td>0.000000</td>
<td>0.026549</td>
<td>0.029851</td>
<td>0.022989</td>
<td>0.000000</td>
<td>0.024096</td>
<td>0.018868</td>
<td>0.037037</td>
<td>0.000000</td>
<td>0.024422</td>
<td>0.021825</td>
</tr>
<tr>
<td>2</td>
<td>2010-03-28</td>
<td>2010</td>
<td>1</td>
<td>Domain Stadium</td>
<td>11712</td>
<td>5096.0</td>
<td>M Cook</td>
<td>8</td>
<td>Adelaide</td>
<td>Fremantle</td>
<td>Away</td>
<td>62</td>
<td>118</td>
<td>-56</td>
<td>0.0</td>
<td>0.035714</td>
<td>0.025362</td>
<td>0.031034</td>
<td>0.026746</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.013333</td>
<td>0.034483</td>
<td>0.021625</td>
<td>0.021505</td>
<td>0.031630</td>
<td>0.026820</td>
<td>0.022599</td>
<td>0.000000</td>
<td>0.045455</td>
<td>0.008850</td>
<td>0.014925</td>
<td>0.011494</td>
<td>0.028986</td>
<td>0.048193</td>
<td>0.056604</td>
<td>0.000000</td>
<td>0.037037</td>
<td>0.020887</td>
<td>0.019703</td>
</tr>
<tr>
<td>3</td>
<td>2010-03-28</td>
<td>2010</td>
<td>1</td>
<td>Domain Stadium</td>
<td>11700</td>
<td>5096.0</td>
<td>P Dangerfield</td>
<td>32</td>
<td>Adelaide</td>
<td>Fremantle</td>
<td>Away</td>
<td>62</td>
<td>118</td>
<td>-56</td>
<td>0.0</td>
<td>0.049107</td>
<td>0.016304</td>
<td>0.017241</td>
<td>0.015605</td>
<td>0.0</td>
<td>0.0</td>
<td>0.04</td>
<td>0.026667</td>
<td>0.172414</td>
<td>0.022734</td>
<td>0.021505</td>
<td>0.029197</td>
<td>0.025543</td>
<td>0.016949</td>
<td>0.038462</td>
<td>0.090909</td>
<td>0.026549</td>
<td>0.000000</td>
<td>0.022989</td>
<td>0.072464</td>
<td>0.024096</td>
<td>0.018868</td>
<td>0.074074</td>
<td>0.037037</td>
<td>0.024422</td>
<td>0.028190</td>
</tr>
<tr>
<td>4</td>
<td>2010-03-28</td>
<td>2010</td>
<td>1</td>
<td>Domain Stadium</td>
<td>85</td>
<td>5096.0</td>
<td>M Doughty</td>
<td>11</td>
<td>Adelaide</td>
<td>Fremantle</td>
<td>Away</td>
<td>62</td>
<td>118</td>
<td>-56</td>
<td>0.0</td>
<td>0.017857</td>
<td>0.021739</td>
<td>0.025862</td>
<td>0.027526</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.053333</td>
<td>0.000000</td>
<td>0.025229</td>
<td>0.010753</td>
<td>0.031630</td>
<td>0.021711</td>
<td>0.016949</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.026549</td>
<td>0.000000</td>
<td>0.011494</td>
<td>0.000000</td>
<td>0.036145</td>
<td>0.037736</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.018959</td>
<td>0.018490</td>
</tr>
</tbody>
</table>
<h3 id="kicked-a-bag-feature">Kicked A Bag Feature</h3>
<pre><code class="language-python">features['kicked_a_bag'] = brownlow_data.G.apply(lambda x: 1 if x &gt;= 5 else 0)
</code></pre>
<h3 id="is-captain-feature">Is Captain Feature</h3>
<pre><code class="language-python">features['is_captain'] = features.apply(lambda x: is_captain_for_that_season(captains, x.player, x.season), axis='columns')
</code></pre>
<h3 id="won-the-game-feature">Won the Game Feature</h3>
<pre><code class="language-python">features['team_won'] = np.where(features.margin &gt; 0, 1, 0)
</code></pre>
<h3 id="30-2-goals-feature">30+ &amp; 2+ Goals Feature</h3>
<pre><code class="language-python">features['got_30_possies_2_goals'] = np.where((brownlow_data.G &gt;= 2) &amp; (brownlow_data.D &gt;= 30), 1, 0)
</code></pre>
<h3 id="previous-top-10-finish-feature">Previous Top 10 Finish Feature</h3>
<p>I have a strong feeling that past performance may be a predictor of future performance in the brownlow. For example, last year Dusty Martin won the Brownlow. The umpires may have a bias towards Dusty this year because he is known to be on their radar as being a good player. Let's create a feature which is categorical and is 1 if the player has previously finished in the top 10. Let's create a function for this and then apply it to the afltables dataset, which has data back to 1897. We will then create a lookup table for the top 10 for each season and merge this table with our current features df.</p>
<pre><code class="language-python">afltables = pd.read_csv('data/afltables_stats.csv').query('Season &gt;= 2000')

def replace_special_characters(name):
    name = name.replace(&quot;'&quot;, &quot;&quot;).replace(&quot;-&quot;, &quot; &quot;).lower()
    name_split = name.split()

    if len(name_split) &gt; 2:
        first_name = name_split[0]
        last_name = name_split[-1]
        name = first_name + ' ' + last_name

    name_split_2 = name.split()
    name = name_split_2[0][0] + ' ' + name_split_2[1]
    return name.title()

afltables = (afltables.assign(player=lambda df: df['First.name'] + ' ' + df.Surname)
                .assign(player=lambda df: df.player.apply(replace_special_characters))
                .rename(columns={'Brownlow.Votes': 'brownlow_votes', 'Season': 'season', 'Playing.for': 'team'}))
</code></pre>
<pre><code class="language-python">### Create Top 10 rank look up table

brownlow_votes_yearly = (afltables.groupby(['season', 'player', 'team'], as_index=False)
                                  .brownlow_votes
                                  .sum())

brownlow_votes_yearly['yearly_rank'] = (brownlow_votes_yearly.groupby('season')
                                                             .brownlow_votes
                                                             .rank(method='max', ascending=False))

# Filter to only get a dataframe since 2000 and only the top 10 players from each season
brownlow_votes_top_10 = brownlow_votes_yearly.query('yearly_rank &lt; 11 &amp; season &gt;= 2000')

brownlow_votes_top_10.head(3)

def how_many_times_top_10(top_10_df, player, year):
    times = len(top_10_df[(top_10_df.player == player) &amp; (top_10_df.season &lt; year)])
    return times

features['times_in_top_10'] = features.apply(lambda x: how_many_times_top_10(brownlow_votes_top_10, x.player, x.season), axis=1) 
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>season</th>
<th>player</th>
<th>team</th>
<th>brownlow_votes</th>
<th>yearly_rank</th>
</tr>
</thead>
<tbody>
<tr>
<td>27</td>
<td>2000.0</td>
<td>A Koutoufides</td>
<td>Carlton</td>
<td>19.0</td>
<td>4.0</td>
</tr>
<tr>
<td>36</td>
<td>2000.0</td>
<td>A Mcleod</td>
<td>Adelaide</td>
<td>20.0</td>
<td>3.0</td>
</tr>
<tr>
<td>105</td>
<td>2000.0</td>
<td>B Ratten</td>
<td>Carlton</td>
<td>18.0</td>
<td>6.0</td>
</tr>
</tbody>
</table>
<h3 id="average-brownlow-votes-per-game-last-season-feature">Average Brownlow Votes Per Game Last Season Feature</h3>
<pre><code class="language-python"># Create a brownlow votes lookup table
brownlow_votes_lookup_table = (brownlow_data.groupby(['player', 'team', 'season'], as_index=False)
                                    .brownlow_votes
                                    .mean()
                                    .assign(next_season=lambda df: df.season + 1)
                                    .rename(columns={
                                        'brownlow_votes': 'ave_votes_last_season'
                                    }))

# Have a look at Cripps to check if it's working
brownlow_votes_lookup_table[brownlow_votes_lookup_table.player == 'P Cripps']

# Merge it to our features df
features_with_votes_last_season = (pd.merge(features, brownlow_votes_lookup_table.drop(columns='season'),

                                             left_on=['player', 'team', 'season'], 
                                             right_on=['player', 'team', 'next_season'],
                                             how='left')
                                  .drop(columns=['next_season'])
                                  .fillna(0))
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>player</th>
<th>team</th>
<th>season</th>
<th>ave_votes_last_season</th>
<th>next_season</th>
</tr>
</thead>
<tbody>
<tr>
<td>4377</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>2014</td>
<td>0.000000</td>
<td>2015</td>
</tr>
<tr>
<td>4378</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>2015</td>
<td>0.300000</td>
<td>2016</td>
</tr>
<tr>
<td>4379</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>2016</td>
<td>0.857143</td>
<td>2017</td>
</tr>
<tr>
<td>4380</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>2017</td>
<td>0.333333</td>
<td>2018</td>
</tr>
<tr>
<td>4381</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>2018</td>
<td>0.000000</td>
<td>2019</td>
</tr>
</tbody>
</table>
<h3 id="historic-performance-relative-to-model-feature">Historic Performance Relative To Model Feature</h3>
<p>It is well known that some players are good Brownlow performers. For whatever reason, they always poll much better than their stats may suggest. Lance Franklin and Bontempelli are probably in this category. Perhaps these players have an X-factor that Machine Learning models struggle to pick up on. To get around this, let's create a feature which looks at the player's performance relative to the model's prediction. To do this, we'll need to train and predict 7 different models - from 2011 to 2017.</p>
<p>To create a model for each season, we will use h2o's AutoML. If you're new to h2o, please read about it <a href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html">here.</a> It can be used in both R and Python.</p>
<p>The metric we will use for loss in Mean Absolute Error (MAE).</p>
<p>As we are using regression, some values are negative. We will convert these negative values to 0 as it doesn't make sense to poll negative brownlow votes. Similarly, some matches won't predict exactly 6 votes, so we will scale these predictions so that we predict exactly 6 votes for each match.</p>
<p>So that you don't have to train these models yourself, I have saved the models and we will load them in. If you are keen to train the models yourself, simply uncomment out the code below and run the cell. To bulk uncomment, highlight the rows and press ctrl + '/'</p>
<pre><code class="language-python">h2o.init()

# Uncomment the code below if you want to train the models yourself - otherwise, we will load them in the load cell from disk

## Join to our features df

# aml_yearly_model_objects = {}
# yearly_predictions_dfs = {}

# feature_cols = ['margin', 'CP', 'UP', 'ED', 'DE',
#        'CM', 'GA', 'MI5', 'one_perc', 'BO', 'TOG', 'K', 'HB', 'D', 'M', 'G',
#        'B', 'T', 'HO', 'I50', 'CL', 'CG', 'R50', 'FF', 'FA', 'AF', 'SC']

# for year in range(2011, 2018):
#     # Filter the data to only include past data
#     train_historic = brownlow_data[brownlow_data.season &lt; year].copy()

#     # Convert to an h2o frame
#     train_h2o_historic = h2o.H2OFrame(train_historic)

#     # Create an AutoML object
#     aml = H2OAutoML(max_runtime_secs=30,
#                    balance_classes=True,
#                    seed=42)

#     # Train the model
#     aml.train(y='brownlow_votes', x=feature_cols, training_frame=train_h2o_historic)

#     # save the model
#     model_path = h2o.save_model(model=aml.leader, path=&quot;models&quot;, force=True)

#     # Get model id
#     model_name = aml.leaderboard[0, 'model_id']

#     # Rename the model on disk
#     os.rename(f'models/{model_name}', f'models/yearly_model_{year}')

#     # Append the best model to a list
#     aml_yearly_model_objects[year] = aml.leader

#     # Make predictions on test set for that year
#     test_historic = brownlow_data[brownlow_data.season == year].copy()
#     test_h2o_historic = h2o.H2OFrame(test_historic)

#     preds = aml.predict(test_h2o_historic).as_data_frame()
#     test_historic['predicted_votes'] = preds.values

#     # Convert negative predictions to 0
#     test_historic['predicted_votes_neg_to_0'] = test_historic.predicted_votes.apply(lambda x: 0 if x &lt; 0 else x)

#     # Create a total match votes column - which calculates the number of votes predicted in each game when the predictions 
#     # are unscaled
#     test_historic['unscaled_match_votes'] = test_historic.groupby('match_id').predicted_votes_neg_to_0.transform('sum')

#     # Scale predictions
#     test_historic['predicted_votes_scaled'] = test_historic.predicted_votes_neg_to_0 / test_historic.unscaled_match_votes * 6

#     # Aggregate the predictions
#     test_grouped = (test_historic.groupby(['player', 'team'], as_index=False)
#                                  .sum()
#                                  .sort_values(by='brownlow_votes', ascending=False)
#                                  .assign(mae=lambda df: abs(df.predicted_votes_scaled - df.brownlow_votes)))

#     test_grouped['error'] = test_grouped.predicted_votes_scaled - test_grouped.brownlow_votes
#     test_grouped['next_year'] = year + 1

#     # Add this years predictions df to a dictionary to use later
#     yearly_predictions_dfs[year] = test_grouped

# preds_errors = None

# for key, value in yearly_predictions_dfs.items():
#     if preds_errors is None:
#         preds_errors = value[['player', 'season', 'next_year', 'brownlow_votes', 'predicted_votes_scaled', 'error']]
#     else:
#         preds_errors = preds_errors.append(value[['player', 'season', 'next_year', 'brownlow_votes', 'predicted_votes_scaled', 'error']], sort=True)

# with open('data/prediction_errors_df.pickle', 'wb') as handle:
#     pickle.dump(yearly_predicted_errors, handle)
</code></pre>
<p>Checking whether there is an H2O instance running at http://localhost:54321. connected.   </p>
<table>
<thead>
<tr>
<th>H2O cluster uptime:</th>
<th>1 hour 28 mins</th>
</tr>
</thead>
<tbody>
<tr>
<td>H2O cluster timezone:</td>
<td>Australia/Hobart</td>
</tr>
<tr>
<td>H2O data parsing timezone:</td>
<td>UTC</td>
</tr>
<tr>
<td>H2O cluster version:</td>
<td>3.20.0.4</td>
</tr>
<tr>
<td>H2O cluster version age:</td>
<td>1 month and 18 days</td>
</tr>
<tr>
<td>H2O cluster name:</td>
<td>H2O_from_python_WardJ_tt2ak5</td>
</tr>
<tr>
<td>H2O cluster total nodes:</td>
<td>1</td>
</tr>
<tr>
<td>H2O cluster free memory:</td>
<td>7.018 Gb</td>
</tr>
<tr>
<td>H2O cluster total cores:</td>
<td>4</td>
</tr>
<tr>
<td>H2O cluster allowed cores:</td>
<td>4</td>
</tr>
<tr>
<td>H2O cluster status:</td>
<td>locked, healthy</td>
</tr>
<tr>
<td>H2O connection url:</td>
<td>http://localhost:54321</td>
</tr>
<tr>
<td>H2O connection proxy:</td>
<td>None</td>
</tr>
<tr>
<td>H2O internal security:</td>
<td>False</td>
</tr>
<tr>
<td>H2O API Extensions:</td>
<td>Algos, AutoML, Core V3, Core V4</td>
</tr>
<tr>
<td>Python version:</td>
<td>3.6.4 final</td>
</tr>
</tbody>
</table>
<pre><code class="language-python"># Load predictions error df    
with open('data/prediction_errors_df.pickle', 'rb') as handle:
    preds_errors = pickle.load(handle)

# Look at last years predictions
preds_errors.query('next_year == 2018').sort_values(by='brownlow_votes', ascending=False).head(20)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>brownlow_votes</th>
<th>error</th>
<th>next_year</th>
<th>player</th>
<th>predicted_votes_scaled</th>
<th>season</th>
</tr>
</thead>
<tbody>
<tr>
<td>139</td>
<td>36.0</td>
<td>-4.915157</td>
<td>2018</td>
<td>D Martin</td>
<td>31.084843</td>
<td>44374</td>
</tr>
<tr>
<td>486</td>
<td>33.0</td>
<td>-4.413780</td>
<td>2018</td>
<td>P Dangerfield</td>
<td>28.586220</td>
<td>42357</td>
</tr>
<tr>
<td>619</td>
<td>25.0</td>
<td>0.072223</td>
<td>2018</td>
<td>T Mitchell</td>
<td>25.072223</td>
<td>44374</td>
</tr>
<tr>
<td>279</td>
<td>23.0</td>
<td>-9.296209</td>
<td>2018</td>
<td>J Kennedy</td>
<td>13.703791</td>
<td>38323</td>
</tr>
<tr>
<td>376</td>
<td>22.0</td>
<td>-7.621336</td>
<td>2018</td>
<td>L Franklin</td>
<td>14.378664</td>
<td>44374</td>
</tr>
<tr>
<td>278</td>
<td>21.0</td>
<td>-3.016176</td>
<td>2018</td>
<td>J Kelly</td>
<td>17.983824</td>
<td>42357</td>
</tr>
<tr>
<td>519</td>
<td>20.0</td>
<td>-4.182915</td>
<td>2018</td>
<td>R Sloane</td>
<td>15.817085</td>
<td>44374</td>
</tr>
<tr>
<td>410</td>
<td>19.0</td>
<td>-7.740142</td>
<td>2018</td>
<td>M Bontempelli</td>
<td>11.259858</td>
<td>44374</td>
</tr>
<tr>
<td>483</td>
<td>18.0</td>
<td>-4.522835</td>
<td>2018</td>
<td>O Wines</td>
<td>13.477165</td>
<td>44374</td>
</tr>
<tr>
<td>121</td>
<td>17.0</td>
<td>-4.446749</td>
<td>2018</td>
<td>D Beams</td>
<td>12.553251</td>
<td>38323</td>
</tr>
<tr>
<td>390</td>
<td>16.0</td>
<td>-3.620094</td>
<td>2018</td>
<td>L Parker</td>
<td>12.379906</td>
<td>44374</td>
</tr>
<tr>
<td>561</td>
<td>15.0</td>
<td>-5.846506</td>
<td>2018</td>
<td>S Pendlebury</td>
<td>9.153494</td>
<td>32272</td>
</tr>
<tr>
<td>463</td>
<td>15.0</td>
<td>-4.402600</td>
<td>2018</td>
<td>N Fyfe</td>
<td>10.597400</td>
<td>42357</td>
</tr>
<tr>
<td>42</td>
<td>15.0</td>
<td>-4.787914</td>
<td>2018</td>
<td>B Ebert</td>
<td>10.212086</td>
<td>44374</td>
</tr>
<tr>
<td>651</td>
<td>15.0</td>
<td>0.824510</td>
<td>2018</td>
<td>Z Merrett</td>
<td>15.824510</td>
<td>42357</td>
</tr>
<tr>
<td>578</td>
<td>14.0</td>
<td>2.300607</td>
<td>2018</td>
<td>T Adams</td>
<td>16.300607</td>
<td>44374</td>
</tr>
<tr>
<td>34</td>
<td>14.0</td>
<td>-5.796604</td>
<td>2018</td>
<td>B Brown</td>
<td>8.203396</td>
<td>44374</td>
</tr>
<tr>
<td>172</td>
<td>14.0</td>
<td>-1.650752</td>
<td>2018</td>
<td>D Zorko</td>
<td>12.349248</td>
<td>42357</td>
</tr>
<tr>
<td>184</td>
<td>14.0</td>
<td>-1.233663</td>
<td>2018</td>
<td>G Ablett</td>
<td>12.766337</td>
<td>28238</td>
</tr>
<tr>
<td>389</td>
<td>14.0</td>
<td>-2.099613</td>
<td>2018</td>
<td>L Neale</td>
<td>11.900387</td>
<td>42357</td>
</tr>
</tbody>
</table>
<p>Look at that! A simply Machine Learning ensemble model, using AutoML predicted last year's winner! That's impressive. As we can see it also predicted Bontempelli would only score 11.26, when he actually scored 19 - a huge discrepency. Let's use this as a feature.</p>
<pre><code class="language-python">features_with_historic_perf_relative_to_model = \
    (features_with_votes_last_season.pipe(pd.merge, preds_errors[['player', 'next_year', 'error']],
                                          left_on=['player', 'season'],
                                          right_on=['player', 'next_year'],
                                          how='left')
                                     .fillna(0)
                                     .rename(columns={'error': 'error_last_season'})
                                     .drop_duplicates(subset=['player', 'round', 'SC']))
</code></pre>
<hr />
<h2 id="filtering-the-data-to-only-include-the-top-20-sc-for-each-match">Filtering the data to only include the top 20 SC for each match</h2>
<p>Logically, it is extremely unlikely that a player will poll votes if their Supercoach score is not in the top 20 players. By eliminating the other 20+ players, we can reduce the noise in the data, as we are almost certain the players won't poll from the bottom half. Let's explore how many players poll if they're not in the top 20, and then filter our df if this number is not significant.</p>
<pre><code class="language-python"># Find number of players who vote when in top 15 SC

brownlow_data['SC_rank_match'] = brownlow_data.groupby('match_id').SC.rank(method='max', ascending=False)

brownlow_data.query('SC_rank_match &gt; 20 and season &gt; 2014').brownlow_votes.value_counts()

    0.0    18330
    1.0       14
    2.0        8
    3.0        2
    Name: brownlow_votes, dtype: int64
</code></pre>
<p>Since 2014, there have only been 24 players who have voted and not been in the top 20 SC.</p>
<pre><code class="language-python">features_with_sc_rank = features_with_historic_perf_relative_to_model.copy()

features_with_sc_rank['SC_rank_match'] = features_with_sc_rank.groupby('match_id').SC.rank(method='max', ascending=False)

# Filter out rows with a SC rank of below 20
features_with_sc_rank_filtered = features_with_sc_rank.query('SC_rank_match &lt;= 20')
</code></pre>
<pre><code class="language-python"># Filter out 2010 and 2011 as we used these seasons to create historic model performance features
features_last_before_train = features_with_sc_rank_filtered.query('season != 2010 and season != 2011').reset_index(drop=True)

features_last_before_train.head(3)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>date</th>
<th>season</th>
<th>round</th>
<th>venue</th>
<th>ID</th>
<th>match_id</th>
<th>player</th>
<th>jumper_no</th>
<th>team</th>
<th>opposition</th>
<th>status</th>
<th>team_score</th>
<th>opposition_score</th>
<th>margin</th>
<th>brownlow_votes</th>
<th>CP</th>
<th>UP</th>
<th>ED</th>
<th>DE</th>
<th>CM</th>
<th>GA</th>
<th>MI5</th>
<th>one_perc</th>
<th>BO</th>
<th>TOG</th>
<th>K</th>
<th>HB</th>
<th>D</th>
<th>M</th>
<th>G</th>
<th>B</th>
<th>T</th>
<th>HO</th>
<th>I50</th>
<th>CL</th>
<th>CG</th>
<th>R50</th>
<th>FF</th>
<th>FA</th>
<th>AF</th>
<th>SC</th>
<th>kicked_a_bag</th>
<th>is_captain</th>
<th>team_won</th>
<th>got_30_possies_2_goals</th>
<th>times_in_top_10</th>
<th>ave_votes_last_season</th>
<th>next_year</th>
<th>error_last_season</th>
<th>SC_rank_match</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>2012-03-31</td>
<td>2012</td>
<td>1</td>
<td>Metricon Stadium</td>
<td>11985</td>
<td>5347.0</td>
<td>I Callinan</td>
<td>37</td>
<td>Adelaide</td>
<td>Gold Coast</td>
<td>Away</td>
<td>137</td>
<td>68</td>
<td>69</td>
<td>0.0</td>
<td>0.031359</td>
<td>0.018947</td>
<td>0.016071</td>
<td>0.015745</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.12</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.023333</td>
<td>0.031674</td>
<td>0.012270</td>
<td>0.023438</td>
<td>0.026042</td>
<td>0.068966</td>
<td>0.217391</td>
<td>0.041322</td>
<td>0.0</td>
<td>0.017241</td>
<td>0.013699</td>
<td>0.042553</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.032258</td>
<td>0.030593</td>
<td>0.026962</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>2012.0</td>
<td>0.042048</td>
<td>14.0</td>
</tr>
<tr>
<td>1</td>
<td>2012-03-31</td>
<td>2012</td>
<td>1</td>
<td>Metricon Stadium</td>
<td>11700</td>
<td>5347.0</td>
<td>P Dangerfield</td>
<td>32</td>
<td>Adelaide</td>
<td>Gold Coast</td>
<td>Away</td>
<td>137</td>
<td>68</td>
<td>69</td>
<td>0.0</td>
<td>0.048780</td>
<td>0.023158</td>
<td>0.037500</td>
<td>0.026451</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.04</td>
<td>0.009804</td>
<td>0.090909</td>
<td>0.025556</td>
<td>0.029412</td>
<td>0.036810</td>
<td>0.032552</td>
<td>0.015625</td>
<td>0.068966</td>
<td>0.000000</td>
<td>0.016529</td>
<td>0.0</td>
<td>0.051724</td>
<td>0.123288</td>
<td>0.042553</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.032258</td>
<td>0.027503</td>
<td>0.028173</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.333333</td>
<td>2012.0</td>
<td>-2.983636</td>
<td>12.0</td>
</tr>
<tr>
<td>2</td>
<td>2012-03-31</td>
<td>2012</td>
<td>1</td>
<td>Metricon Stadium</td>
<td>2381</td>
<td>5347.0</td>
<td>R Douglas</td>
<td>26</td>
<td>Adelaide</td>
<td>Gold Coast</td>
<td>Away</td>
<td>137</td>
<td>68</td>
<td>69</td>
<td>0.0</td>
<td>0.020906</td>
<td>0.033684</td>
<td>0.021429</td>
<td>0.019901</td>
<td>0.0</td>
<td>0.083333</td>
<td>0.04</td>
<td>0.049020</td>
<td>0.000000</td>
<td>0.023056</td>
<td>0.031674</td>
<td>0.015337</td>
<td>0.024740</td>
<td>0.031250</td>
<td>0.034483</td>
<td>0.130435</td>
<td>0.057851</td>
<td>0.0</td>
<td>0.043103</td>
<td>0.000000</td>
<td>0.031915</td>
<td>0.014493</td>
<td>0.064516</td>
<td>0.000000</td>
<td>0.033684</td>
<td>0.030597</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>2012.0</td>
<td>1.724915</td>
<td>10.0</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="modeling-the-2017-brownlow">Modeling The 2017 Brownlow</h2>
<p>Now that we have all of our features, we can simply create a training set (2012-2016), and a test set (2017), and make our predictions for last year! We will use AutoML for this process again. Again, rather than waiting for the model to train, I will save the model so you can simply load it in. We will also scale our features. We can then see how our model went in predicting last year's brownlow, creating a baseline for this years' predictions. We will then predict this year's vote count.</p>
<pre><code class="language-python">train_baseline = features_last_before_train.query(&quot;season &lt; 2017&quot;)
holdout = features_last_before_train.query(&quot;season == 2017&quot;)

scale_cols = ['team_score', 'opposition_score', 'margin', 'CP', 'UP', 'ED', 'DE',
       'CM', 'GA', 'MI5', 'one_perc', 'BO', 'K', 'HB', 'D', 'M', 'G',
       'B', 'T', 'HO', 'I50', 'CL', 'CG', 'R50', 'FF', 'FA', 'AF', 'SC']

other_feature_cols = ['is_captain', 'kicked_a_bag', 'team_won', 'got_30_possies_2_goals', 'times_in_top_10', 
                      'ave_votes_last_season', 'error_last_season', 'SC_rank_match']

all_feature_cols = scale_cols + other_feature_cols

# Scale features
scaler = StandardScaler()

train_baseline_scaled = train_baseline.copy()
train_baseline_scaled[scale_cols] = scaler.fit_transform(train_baseline[scale_cols])

holdout_scaled = holdout.copy()
holdout_scaled[scale_cols] = scaler.transform(holdout[scale_cols])

# Convert categorical columns to categoricals
train_baseline_h2o = h2o.H2OFrame(train_baseline_scaled)
holdout_h2o = h2o.H2OFrame(holdout_scaled)

for col in ['is_captain', 'kicked_a_bag', 'team_won', 'got_30_possies_2_goals']:
    train_baseline_h2o[col] = train_baseline_h2o[col].asfactor()
    holdout_h2o[col] = holdout_h2o[col].asfactor()
</code></pre>
<pre><code>C:\Users\wardj\AppData\Local\Continuum\anaconda3\lib\site-packages\h2o\utils\shared_utils.py:177: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
  data = _handle_python_lists(python_obj.as_matrix().tolist(), -1)[1]

Parse progress: || 100%
Parse progress: || 100%
</code></pre>
<p>Below I have commented out training and saving the 2017 model. Rather than training it again, we will just load it in. Uncomment this part out if you want to train it yourself.</p>
<pre><code class="language-python"># aml_2017_model = H2OAutoML(max_runtime_secs = 60*3,
#                    balance_classes=True,
#                    seed=42)

# aml_2017_model.train(y='brownlow_votes', x=all_feature_cols, training_frame=train_baseline_h2o)
</code></pre>
<pre><code class="language-python"># save the model
# model_path = h2o.save_model(model=aml_2017_model.leader, path=&quot;models&quot;, force=True)

# Get model id
# model_name = aml_2017_model.leaderboard[0, 'model_id']

# Rename the model on disk
# os.rename(f'models/{model_name}', f'models/brownlow_2017_model_v1')

# Load model in
aml_2017_model = h2o.load_model('models/brownlow_2017_model_v1')
</code></pre>
<pre><code class="language-python"># Predict the 2017 brownlow count
preds_final_2017_model = aml_2017_model.predict(holdout_h2o)

# Scale these predictions - change negatives to 0s and scale so each game predicts 6 votes total
holdout = (holdout.assign(predicted_votes=preds_final_2017_model.as_data_frame().values)
                  .assign(predicted_votes_neg_to_0=lambda df: df.predicted_votes.apply(lambda x: 0 if x &lt;0 else x))
                  .assign(unscaled_match_votes=lambda df: df.groupby('match_id').predicted_votes_neg_to_0.transform('sum'))
                  .assign(predicted_votes_scaled=lambda df: df.predicted_votes_neg_to_0 / df.unscaled_match_votes * 6))

# Create an aggregate votes df and show the average SC points and goals scored
agg_predictions_2017 = (holdout.groupby(['player', 'team'], as_index=False)
                        .agg({
                            'brownlow_votes': sum,
                            'predicted_votes_scaled': sum,
                            'SC': 'mean',
                            'G': 'mean'})
                        .sort_values(by='brownlow_votes', ascending=False)
                        .assign(mae=lambda df: abs(df.brownlow_votes - df.predicted_votes_scaled))
                        .reset_index(drop=True))
</code></pre>
<pre><code>stackedensemble prediction progress: || 100%
</code></pre>
<pre><code class="language-python">agg_predictions_2017.head(15)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>player</th>
<th>team</th>
<th>brownlow_votes</th>
<th>predicted_votes_scaled</th>
<th>SC</th>
<th>G</th>
<th>mae</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>D Martin</td>
<td>Richmond</td>
<td>36.0</td>
<td>37.271060</td>
<td>0.037862</td>
<td>0.064869</td>
<td>1.271060</td>
</tr>
<tr>
<td>1</td>
<td>P Dangerfield</td>
<td>Geelong</td>
<td>33.0</td>
<td>39.288122</td>
<td>0.042441</td>
<td>0.070819</td>
<td>6.288122</td>
</tr>
<tr>
<td>2</td>
<td>T Mitchell</td>
<td>Hawthorn</td>
<td>25.0</td>
<td>28.629859</td>
<td>0.036040</td>
<td>0.016928</td>
<td>3.629859</td>
</tr>
<tr>
<td>3</td>
<td>L Franklin</td>
<td>Sydney</td>
<td>22.0</td>
<td>16.353733</td>
<td>0.034640</td>
<td>0.149203</td>
<td>5.646267</td>
</tr>
<tr>
<td>4</td>
<td>J Kelly</td>
<td>GWS</td>
<td>21.0</td>
<td>19.565321</td>
<td>0.034652</td>
<td>0.033772</td>
<td>1.434679</td>
</tr>
<tr>
<td>5</td>
<td>R Sloane</td>
<td>Adelaide</td>
<td>20.0</td>
<td>21.417347</td>
<td>0.037068</td>
<td>0.034821</td>
<td>1.417347</td>
</tr>
<tr>
<td>6</td>
<td>J Kennedy</td>
<td>Sydney</td>
<td>20.0</td>
<td>13.671891</td>
<td>0.032014</td>
<td>0.030508</td>
<td>6.328109</td>
</tr>
<tr>
<td>7</td>
<td>M Bontempelli</td>
<td>Western Bulldogs</td>
<td>19.0</td>
<td>17.461889</td>
<td>0.033233</td>
<td>0.040498</td>
<td>1.538111</td>
</tr>
<tr>
<td>8</td>
<td>D Beams</td>
<td>Brisbane</td>
<td>17.0</td>
<td>15.414730</td>
<td>0.034848</td>
<td>0.044998</td>
<td>1.585270</td>
</tr>
<tr>
<td>9</td>
<td>O Wines</td>
<td>Port Adelaide</td>
<td>16.0</td>
<td>12.973973</td>
<td>0.031601</td>
<td>0.021967</td>
<td>3.026027</td>
</tr>
<tr>
<td>10</td>
<td>N Fyfe</td>
<td>Fremantle</td>
<td>15.0</td>
<td>11.926030</td>
<td>0.033761</td>
<td>0.031680</td>
<td>3.073970</td>
</tr>
<tr>
<td>11</td>
<td>S Pendlebury</td>
<td>Collingwood</td>
<td>15.0</td>
<td>10.845214</td>
<td>0.033855</td>
<td>0.013660</td>
<td>4.154786</td>
</tr>
<tr>
<td>12</td>
<td>B Ebert</td>
<td>Port Adelaide</td>
<td>15.0</td>
<td>7.633526</td>
<td>0.032795</td>
<td>0.008431</td>
<td>7.366474</td>
</tr>
<tr>
<td>13</td>
<td>L Parker</td>
<td>Sydney</td>
<td>15.0</td>
<td>14.680079</td>
<td>0.031366</td>
<td>0.030311</td>
<td>0.319921</td>
</tr>
<tr>
<td>14</td>
<td>Z Merrett</td>
<td>Essendon</td>
<td>15.0</td>
<td>21.063889</td>
<td>0.033737</td>
<td>0.015362</td>
<td>6.063889</td>
</tr>
</tbody>
</table>
<p>So whilst our model predicted Dangerfield to win, it was pretty damn accurate! Let's find the MAE for the top 100, 50, 25, and 10, and then compare it to 2018's MAE in week, when the Brownlow has been counted.</p>
<pre><code class="language-python">for top_x in [10, 25, 50, 100]:
    temp_mae = round(agg_predictions_2017.iloc[:top_x].mae.mean(), 3)
    print(f&quot;The Average Mean Absolute Error for the top {top_x} is {temp_mae}&quot;)
</code></pre>
<pre><code>The Average Mean Absolute Error for the top 10 is 3.216
The Average Mean Absolute Error for the top 25 is 2.931
The Average Mean Absolute Error for the top 50 is 3.15
The Average Mean Absolute Error for the top 100 is 2.577
</code></pre>
<hr />
<h2 id="modelling-this-years-brownlow">Modelling This Year's Brownlow</h2>
<p>Let's now predict this year's vote count. These predictions will be on the front page of the GitHub.</p>
<pre><code class="language-python">train = features_last_before_train.query(&quot;season &lt; 2018&quot;)
test = features_last_before_train.query(&quot;season == 2018&quot;)

# Scale features
scaler = StandardScaler()

train_scaled = train.copy()
train_scaled[scale_cols] = scaler.fit_transform(train[scale_cols])

test_scaled = test.copy()
test_scaled[scale_cols] = scaler.transform(test[scale_cols])
</code></pre>
<pre><code class="language-python"># Convert categorical columns to categoricals

train_h2o = h2o.H2OFrame(train_scaled)
test_h2o = h2o.H2OFrame(test_scaled)

for col in ['is_captain', 'kicked_a_bag', 'team_won', 'got_30_possies_2_goals']:
    train_h2o[col] = train_h2o[col].asfactor()
    test_h2o[col] = test_h2o[col].asfactor()
</code></pre>
<pre><code>C:\Users\wardj\AppData\Local\Continuum\anaconda3\lib\site-packages\h2o\utils\shared_utils.py:177: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
  data = _handle_python_lists(python_obj.as_matrix().tolist(), -1)[1]

Parse progress: || 100%
Parse progress: || 100%
</code></pre>
<pre><code class="language-python"># Train the model - this part is commented out as we will just load our model from disk

# aml = H2OAutoML(max_runtime_secs = 60*3,
#                    balance_classes=True,
#                    seed=42)

# aml.train(y='brownlow_votes', x=all_feature_cols, training_frame=train_h2o)
</code></pre>
<pre><code class="language-python"># # save the model
# model_path = h2o.save_model(model=aml.leader, path=&quot;models&quot;, force=True)

# # Get model id
# model_name = aml.leaderboard[0, 'model_id']

# # Rename the model on disk
# os.rename(f'models/{model_name}', f'models/brownlow_2018_model_v1')

# Load model in
aml = h2o.load_model('models/brownlow_2018_model_v1')
</code></pre>
<pre><code class="language-python"># Predict the 2018 brownlow count
preds_final_2018_model = aml.predict(test_h2o)

# Scale these predictions - change negatives to 0s and scale so each game predicts 6 votes total
test = (test.assign(predicted_votes=preds_final_2018_model.as_data_frame().values)
                  .assign(predicted_votes_neg_to_0=lambda df: df.predicted_votes.apply(lambda x: 0 if x &lt;0 else x))
                  .assign(unscaled_match_votes=lambda df: df.groupby('match_id').predicted_votes_neg_to_0.transform('sum'))
                  .assign(predicted_votes_scaled=lambda df: df.predicted_votes_neg_to_0 / df.unscaled_match_votes * 6))

# Create an aggregate votes df and show the average SC points and goals scored
agg_predictions_2018 = (test.groupby(['player', 'team'], as_index=False)
                        .agg({
                            'predicted_votes_scaled': sum,
                            'match_id': 'count'}) # shows how many games they played
                        .sort_values(by='predicted_votes_scaled', ascending=False)
                        .reset_index(drop=True))
</code></pre>
<pre><code>stackedensemble prediction progress: || 100%
</code></pre>
<pre><code class="language-python"># Show the top 25 predictions

agg_predictions_2018.head(25)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>player</th>
<th>team</th>
<th>predicted_votes_scaled</th>
<th>match_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>T Mitchell</td>
<td>Hawthorn</td>
<td>35.484614</td>
<td>20</td>
</tr>
<tr>
<td>1</td>
<td>M Gawn</td>
<td>Melbourne</td>
<td>21.544278</td>
<td>22</td>
</tr>
<tr>
<td>2</td>
<td>D Martin</td>
<td>Richmond</td>
<td>20.444488</td>
<td>19</td>
</tr>
<tr>
<td>3</td>
<td>B Grundy</td>
<td>Collingwood</td>
<td>19.543511</td>
<td>22</td>
</tr>
<tr>
<td>4</td>
<td>C Oliver</td>
<td>Melbourne</td>
<td>19.009628</td>
<td>20</td>
</tr>
<tr>
<td>5</td>
<td>J Macrae</td>
<td>Western Bulldogs</td>
<td>18.931594</td>
<td>17</td>
</tr>
<tr>
<td>6</td>
<td>P Dangerfield</td>
<td>Geelong</td>
<td>18.621242</td>
<td>21</td>
</tr>
<tr>
<td>7</td>
<td>D Beams</td>
<td>Brisbane</td>
<td>17.621222</td>
<td>15</td>
</tr>
<tr>
<td>8</td>
<td>E Yeo</td>
<td>West Coast</td>
<td>16.015638</td>
<td>20</td>
</tr>
<tr>
<td>9</td>
<td>L Neale</td>
<td>Fremantle</td>
<td>15.495083</td>
<td>21</td>
</tr>
<tr>
<td>10</td>
<td>A Gaff</td>
<td>West Coast</td>
<td>15.165629</td>
<td>18</td>
</tr>
<tr>
<td>11</td>
<td>D Heppell</td>
<td>Essendon</td>
<td>15.083797</td>
<td>19</td>
</tr>
<tr>
<td>12</td>
<td>J Selwood</td>
<td>Geelong</td>
<td>14.989096</td>
<td>18</td>
</tr>
<tr>
<td>13</td>
<td>S Sidebottom</td>
<td>Collingwood</td>
<td>14.863136</td>
<td>18</td>
</tr>
<tr>
<td>14</td>
<td>N Fyfe</td>
<td>Fremantle</td>
<td>14.692243</td>
<td>11</td>
</tr>
<tr>
<td>15</td>
<td>J Kennedy</td>
<td>Sydney</td>
<td>14.404489</td>
<td>16</td>
</tr>
<tr>
<td>16</td>
<td>Z Merrett</td>
<td>Essendon</td>
<td>13.632131</td>
<td>18</td>
</tr>
<tr>
<td>17</td>
<td>M Crouch</td>
<td>Adelaide</td>
<td>13.503858</td>
<td>16</td>
</tr>
<tr>
<td>18</td>
<td>R Laird</td>
<td>Adelaide</td>
<td>13.274869</td>
<td>19</td>
</tr>
<tr>
<td>19</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>13.240568</td>
<td>21</td>
</tr>
<tr>
<td>20</td>
<td>G Ablett</td>
<td>Geelong</td>
<td>13.018950</td>
<td>15</td>
</tr>
<tr>
<td>21</td>
<td>L Franklin</td>
<td>Sydney</td>
<td>12.792476</td>
<td>13</td>
</tr>
<tr>
<td>22</td>
<td>J Lloyd</td>
<td>Sydney</td>
<td>12.174224</td>
<td>20</td>
</tr>
<tr>
<td>23</td>
<td>J Kelly</td>
<td>GWS</td>
<td>11.982157</td>
<td>14</td>
</tr>
<tr>
<td>24</td>
<td>C Ward</td>
<td>GWS</td>
<td>11.892443</td>
<td>19</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">print(agg_predictions_2018.head(15))
</code></pre>
<table>
<thead>
<tr>
<th>player</th>
<th>team</th>
<th>predicted_votes_scaled</th>
<th>match_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>T Mitchell</td>
<td>Hawthorn</td>
<td>35.484614</td>
</tr>
<tr>
<td>1</td>
<td>M Gawn</td>
<td>Melbourne</td>
<td>21.544278</td>
</tr>
<tr>
<td>2</td>
<td>D Martin</td>
<td>Richmond</td>
<td>20.444488</td>
</tr>
<tr>
<td>3</td>
<td>B Grundy</td>
<td>Collingwood</td>
<td>19.543511</td>
</tr>
<tr>
<td>4</td>
<td>C Oliver</td>
<td>Melbourne</td>
<td>19.009628</td>
</tr>
<tr>
<td>5</td>
<td>J Macrae</td>
<td>Western Bulldogs</td>
<td>18.931594</td>
</tr>
<tr>
<td>6</td>
<td>P Dangerfield</td>
<td>Geelong</td>
<td>18.621242</td>
</tr>
<tr>
<td>7</td>
<td>D Beams</td>
<td>Brisbane</td>
<td>17.621222</td>
</tr>
<tr>
<td>8</td>
<td>E Yeo</td>
<td>West Coast</td>
<td>16.015638</td>
</tr>
<tr>
<td>9</td>
<td>L Neale</td>
<td>Fremantle</td>
<td>15.495083</td>
</tr>
<tr>
<td>10</td>
<td>A Gaff</td>
<td>West Coast</td>
<td>15.165629</td>
</tr>
<tr>
<td>11</td>
<td>D Heppell</td>
<td>Essendon</td>
<td>15.083797</td>
</tr>
<tr>
<td>12</td>
<td>J Selwood</td>
<td>Geelong</td>
<td>14.989096</td>
</tr>
<tr>
<td>13</td>
<td>S Sidebottom</td>
<td>Collingwood</td>
<td>14.863136</td>
</tr>
<tr>
<td>14</td>
<td>N Fyfe</td>
<td>Fremantle</td>
<td>14.692243</td>
</tr>
</tbody>
</table>
<p>Now that we have the top 25, let's also look at the top 3 from each team.</p>
<pre><code class="language-python">agg_predictions_2018.sort_values(by=['team', 'predicted_votes_scaled'], ascending=[True, False]).groupby('team').head(3)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>player</th>
<th>team</th>
<th>predicted_votes_scaled</th>
<th>match_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>17</td>
<td>M Crouch</td>
<td>Adelaide</td>
<td>13.503858</td>
<td>16</td>
</tr>
<tr>
<td>18</td>
<td>R Laird</td>
<td>Adelaide</td>
<td>13.274869</td>
<td>19</td>
</tr>
<tr>
<td>51</td>
<td>B Gibbs</td>
<td>Adelaide</td>
<td>7.783425</td>
<td>18</td>
</tr>
<tr>
<td>7</td>
<td>D Beams</td>
<td>Brisbane</td>
<td>17.621222</td>
<td>15</td>
</tr>
<tr>
<td>46</td>
<td>D Zorko</td>
<td>Brisbane</td>
<td>8.123915</td>
<td>14</td>
</tr>
<tr>
<td>55</td>
<td>S Martin</td>
<td>Brisbane</td>
<td>7.243428</td>
<td>19</td>
</tr>
<tr>
<td>19</td>
<td>P Cripps</td>
<td>Carlton</td>
<td>13.240568</td>
<td>21</td>
</tr>
<tr>
<td>50</td>
<td>K Simpson</td>
<td>Carlton</td>
<td>7.864995</td>
<td>18</td>
</tr>
<tr>
<td>88</td>
<td>E Curnow</td>
<td>Carlton</td>
<td>3.725292</td>
<td>19</td>
</tr>
<tr>
<td>3</td>
<td>B Grundy</td>
<td>Collingwood</td>
<td>19.543511</td>
<td>22</td>
</tr>
<tr>
<td>13</td>
<td>S Sidebottom</td>
<td>Collingwood</td>
<td>14.863136</td>
<td>18</td>
</tr>
<tr>
<td>31</td>
<td>A Treloar</td>
<td>Collingwood</td>
<td>10.487535</td>
<td>11</td>
</tr>
<tr>
<td>11</td>
<td>D Heppell</td>
<td>Essendon</td>
<td>15.083797</td>
<td>19</td>
</tr>
<tr>
<td>16</td>
<td>Z Merrett</td>
<td>Essendon</td>
<td>13.632131</td>
<td>18</td>
</tr>
<tr>
<td>57</td>
<td>D Smith</td>
<td>Essendon</td>
<td>6.838857</td>
<td>20</td>
</tr>
<tr>
<td>9</td>
<td>L Neale</td>
<td>Fremantle</td>
<td>15.495083</td>
<td>21</td>
</tr>
<tr>
<td>14</td>
<td>N Fyfe</td>
<td>Fremantle</td>
<td>14.692243</td>
<td>11</td>
</tr>
<tr>
<td>74</td>
<td>M Walters</td>
<td>Fremantle</td>
<td>5.120949</td>
<td>12</td>
</tr>
<tr>
<td>23</td>
<td>J Kelly</td>
<td>GWS</td>
<td>11.982157</td>
<td>14</td>
</tr>
<tr>
<td>24</td>
<td>C Ward</td>
<td>GWS</td>
<td>11.892443</td>
<td>19</td>
</tr>
<tr>
<td>25</td>
<td>S Coniglio</td>
<td>GWS</td>
<td>11.785273</td>
<td>20</td>
</tr>
<tr>
<td>6</td>
<td>P Dangerfield</td>
<td>Geelong</td>
<td>18.621242</td>
<td>21</td>
</tr>
<tr>
<td>12</td>
<td>J Selwood</td>
<td>Geelong</td>
<td>14.989096</td>
<td>18</td>
</tr>
<tr>
<td>20</td>
<td>G Ablett</td>
<td>Geelong</td>
<td>13.018950</td>
<td>15</td>
</tr>
<tr>
<td>80</td>
<td>J Witts</td>
<td>Gold Coast</td>
<td>4.617273</td>
<td>13</td>
</tr>
<tr>
<td>85</td>
<td>J Lyons</td>
<td>Gold Coast</td>
<td>4.043711</td>
<td>14</td>
</tr>
<tr>
<td>114</td>
<td>B Fiorini</td>
<td>Gold Coast</td>
<td>2.798683</td>
<td>6</td>
</tr>
<tr>
<td>0</td>
<td>T Mitchell</td>
<td>Hawthorn</td>
<td>35.484614</td>
<td>20</td>
</tr>
<tr>
<td>39</td>
<td>L Breust</td>
<td>Hawthorn</td>
<td>9.286521</td>
<td>16</td>
</tr>
<tr>
<td>45</td>
<td>J Gunston</td>
<td>Hawthorn</td>
<td>8.341824</td>
<td>19</td>
</tr>
<tr>
<td>1</td>
<td>M Gawn</td>
<td>Melbourne</td>
<td>21.544278</td>
<td>22</td>
</tr>
<tr>
<td>4</td>
<td>C Oliver</td>
<td>Melbourne</td>
<td>19.009628</td>
<td>20</td>
</tr>
<tr>
<td>32</td>
<td>J Hogan</td>
<td>Melbourne</td>
<td>10.198873</td>
<td>13</td>
</tr>
<tr>
<td>26</td>
<td>S Higgins</td>
<td>North Melbourne</td>
<td>11.327596</td>
<td>19</td>
</tr>
<tr>
<td>37</td>
<td>B Brown</td>
<td>North Melbourne</td>
<td>9.550205</td>
<td>13</td>
</tr>
<tr>
<td>42</td>
<td>B Cunnington</td>
<td>North Melbourne</td>
<td>8.857294</td>
<td>17</td>
</tr>
<tr>
<td>27</td>
<td>O Wines</td>
<td>Port Adelaide</td>
<td>11.118795</td>
<td>16</td>
</tr>
<tr>
<td>36</td>
<td>R Gray</td>
<td>Port Adelaide</td>
<td>9.606960</td>
<td>17</td>
</tr>
<tr>
<td>54</td>
<td>J Westhoff</td>
<td>Port Adelaide</td>
<td>7.355449</td>
<td>21</td>
</tr>
<tr>
<td>2</td>
<td>D Martin</td>
<td>Richmond</td>
<td>20.444488</td>
<td>19</td>
</tr>
<tr>
<td>30</td>
<td>J Riewoldt</td>
<td>Richmond</td>
<td>10.557749</td>
<td>15</td>
</tr>
<tr>
<td>59</td>
<td>T Cotchin</td>
<td>Richmond</td>
<td>6.741732</td>
<td>12</td>
</tr>
<tr>
<td>41</td>
<td>S Ross</td>
<td>St Kilda</td>
<td>9.093395</td>
<td>17</td>
</tr>
<tr>
<td>48</td>
<td>J Steven</td>
<td>St Kilda</td>
<td>8.099164</td>
<td>17</td>
</tr>
<tr>
<td>90</td>
<td>J Steele</td>
<td>St Kilda</td>
<td>3.617769</td>
<td>16</td>
</tr>
<tr>
<td>15</td>
<td>J Kennedy</td>
<td>Sydney</td>
<td>14.404489</td>
<td>16</td>
</tr>
<tr>
<td>21</td>
<td>L Franklin</td>
<td>Sydney</td>
<td>12.792476</td>
<td>13</td>
</tr>
<tr>
<td>22</td>
<td>J Lloyd</td>
<td>Sydney</td>
<td>12.174224</td>
<td>20</td>
</tr>
<tr>
<td>8</td>
<td>E Yeo</td>
<td>West Coast</td>
<td>16.015638</td>
<td>20</td>
</tr>
<tr>
<td>10</td>
<td>A Gaff</td>
<td>West Coast</td>
<td>15.165629</td>
<td>18</td>
</tr>
<tr>
<td>38</td>
<td>J Redden</td>
<td>West Coast</td>
<td>9.368163</td>
<td>16</td>
</tr>
<tr>
<td>5</td>
<td>J Macrae</td>
<td>Western Bulldogs</td>
<td>18.931594</td>
<td>17</td>
</tr>
<tr>
<td>40</td>
<td>M Bontempelli</td>
<td>Western Bulldogs</td>
<td>9.272771</td>
<td>16</td>
</tr>
<tr>
<td>44</td>
<td>L Hunter</td>
<td>Western Bulldogs</td>
<td>8.349606</td>
<td>17</td>
</tr>
</tbody>
</table>
<p>If you're looking for a round by round breakdown, just have a look at the test dataframe.</p>
<pre><code class="language-python">test[['date', 'round', 'player', 'team', 'opposition', 'margin', 'SC', 'predicted_votes_scaled']].tail(25)
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th>date</th>
<th>round</th>
<th>player</th>
<th>team</th>
<th>opposition</th>
<th>margin</th>
<th>SC</th>
<th>predicted_votes_scaled</th>
</tr>
</thead>
<tbody>
<tr>
<td>27231</td>
<td>2018-08-26</td>
<td>23</td>
<td>R Lobb</td>
<td>GWS</td>
<td>Melbourne</td>
<td>-45</td>
<td>0.027576</td>
<td>0.007501</td>
</tr>
<tr>
<td>27232</td>
<td>2018-08-26</td>
<td>23</td>
<td>H Perryman</td>
<td>GWS</td>
<td>Melbourne</td>
<td>-45</td>
<td>0.025758</td>
<td>0.000000</td>
</tr>
<tr>
<td>27233</td>
<td>2018-08-26</td>
<td>23</td>
<td>D Shiel</td>
<td>GWS</td>
<td>Melbourne</td>
<td>-45</td>
<td>0.026364</td>
<td>0.000000</td>
</tr>
<tr>
<td>27234</td>
<td>2018-08-26</td>
<td>23</td>
<td>A Tomlinson</td>
<td>GWS</td>
<td>Melbourne</td>
<td>-45</td>
<td>0.026667</td>
<td>0.000000</td>
</tr>
<tr>
<td>27235</td>
<td>2018-08-26</td>
<td>23</td>
<td>C Ward</td>
<td>GWS</td>
<td>Melbourne</td>
<td>-45</td>
<td>0.035455</td>
<td>0.332057</td>
</tr>
<tr>
<td>27236</td>
<td>2018-08-26</td>
<td>23</td>
<td>L Austin</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.027853</td>
<td>0.003928</td>
</tr>
<tr>
<td>27237</td>
<td>2018-08-26</td>
<td>23</td>
<td>J Geary</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.025129</td>
<td>0.000000</td>
</tr>
<tr>
<td>27238</td>
<td>2018-08-26</td>
<td>23</td>
<td>S Gilbert</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.025734</td>
<td>0.000000</td>
</tr>
<tr>
<td>27239</td>
<td>2018-08-26</td>
<td>23</td>
<td>R Marshall</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.028156</td>
<td>0.103389</td>
</tr>
<tr>
<td>27240</td>
<td>2018-08-26</td>
<td>23</td>
<td>B Paton</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.023918</td>
<td>0.000000</td>
</tr>
<tr>
<td>27241</td>
<td>2018-08-26</td>
<td>23</td>
<td>S Ross</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.039055</td>
<td>0.300392</td>
</tr>
<tr>
<td>27242</td>
<td>2018-08-26</td>
<td>23</td>
<td>J Steele</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.042386</td>
<td>1.094723</td>
</tr>
<tr>
<td>27243</td>
<td>2018-08-26</td>
<td>23</td>
<td>J Steven</td>
<td>St Kilda</td>
<td>North Melbourne</td>
<td>-23</td>
<td>0.046624</td>
<td>1.119684</td>
</tr>
<tr>
<td>27244</td>
<td>2018-08-26</td>
<td>23</td>
<td>R Clarke</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.021193</td>
<td>0.050859</td>
</tr>
<tr>
<td>27245</td>
<td>2018-08-26</td>
<td>23</td>
<td>B Cunnington</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.032698</td>
<td>0.212364</td>
</tr>
<tr>
<td>27246</td>
<td>2018-08-26</td>
<td>23</td>
<td>M Daw</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.022404</td>
<td>0.021889</td>
</tr>
<tr>
<td>27247</td>
<td>2018-08-26</td>
<td>23</td>
<td>T Dumont</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.049046</td>
<td>2.042550</td>
</tr>
<tr>
<td>27248</td>
<td>2018-08-26</td>
<td>23</td>
<td>T Goldstein</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.037844</td>
<td>0.347199</td>
</tr>
<tr>
<td>27249</td>
<td>2018-08-26</td>
<td>23</td>
<td>S Higgins</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.039358</td>
<td>0.508419</td>
</tr>
<tr>
<td>27250</td>
<td>2018-08-26</td>
<td>23</td>
<td>N Hrovat</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.025129</td>
<td>0.012548</td>
</tr>
<tr>
<td>27251</td>
<td>2018-08-26</td>
<td>23</td>
<td>J Macmillan</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.024220</td>
<td>0.000000</td>
</tr>
<tr>
<td>27252</td>
<td>2018-08-26</td>
<td>23</td>
<td>J Waite</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.025734</td>
<td>0.057826</td>
</tr>
<tr>
<td>27253</td>
<td>2018-08-26</td>
<td>23</td>
<td>M Williams</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.023312</td>
<td>0.000000</td>
</tr>
<tr>
<td>27254</td>
<td>2018-08-26</td>
<td>23</td>
<td>S Wright</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.029064</td>
<td>0.093219</td>
</tr>
<tr>
<td>27255</td>
<td>2018-08-26</td>
<td>23</td>
<td>J Ziebell</td>
<td>North Melbourne</td>
<td>St Kilda</td>
<td>23</td>
<td>0.033000</td>
<td>0.031010</td>
</tr>
</tbody>
</table>
<p>And there we have it! In a single notebook we have made a fairly good Brownlow predictive model. Enjoy.</p>
<hr />
<h3 id="disclaimer">Disclaimer</h3>
<p>Note that whilst models and automated strategies are fun and rewarding to create, we can't promise that your model or betting strategy will be profitable, and we make no representations in relation to the code shared or information on this page. If you're using this code or implementing your own strategies, you do so entirely at your own risk and you are responsible for any winnings/losses incurred. Under no circumstances will Betfair be liable for any loss or damage you suffer.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
    
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../AFLmodellingPython/" class="md-footer__link md-footer__link--prev" aria-label="Previous: AFL modelling walk through in Python" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                AFL modelling walk through in Python
              </div>
            </div>
          </a>
        
        
          
          <a href="../howToModelTheAusOpen/" class="md-footer__link md-footer__link--next" aria-label="Next: How to model the Australian Open" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                How to model the Australian Open
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-copyright">
  
  
</div>
        
          <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/Betfair_Aus" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://linkedin.com/company/betfair-australia" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://facebook.com/betfairaustralia" target="_blank" rel="noopener" title="facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://youtube.com/user/betfairaus" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/betfair-datascientists" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
        
      </div>

      <div class="bf-footer">
          <div class="bf-footer-inner">
              <p class="bf-light">Betfair Pty Limited is licensed and regulated by the Northern Territory Government of Australia.</p>
              <p class="bf-dark">Betfair Pty Limited's gambling operations are governed by its Responsible Gambling Code of Conduct and for South
              Australian residents by the South Australian Responsible Gambling Code of Practice.<br /> Think! About your choices. Dont let the game play you. Stay in control. Gamble responsibly. Call Gambling Help 1800 858 858 <a href="https://gamblinghelponline.org.au">www.gamblinghelponline.org.au</a></p>
          
              <ul class="bf-links">
                <li><a href="https://www.betfair.com.au/hub/help/account-help/responsible-gambling/">Responsible Gambling</a><span>|</span></li>
                <li><a href="http://www.betfair.com/AUS_NZL/aboutUs/Terms.and.Conditions/">Terms & Conditions</a><span>|</span></li>
                <li><a href="https://www.betfair.com.au/info/privacy-policy/">Privacy Policy</a><span>|</span></li>
                <li><a href="http://www.betfair.com/en/aboutUs/Rules.and.Regulations/">Rules & Regulations</a><span>|</span></li>
                <li><a href="https://www.betfair.com/AUS_NZL/aboutUs/Dispute.Resolution">Dispute Resolution</a></li>
              </ul>
          </div>
      </div>
    </div>

    <script src="https://js.adsrvr.org/up_loader.1.1.0.js" type="text/javascript"></script>
    <script type="text/javascript">
        ttd_dom_ready( function() {
            if (typeof TTDUniversalPixelApi === 'function') {
                var universalPixelApi = new TTDUniversalPixelApi();
                universalPixelApi.init("y12d1ir", ["8ml4f17"], "https://insight.adsrvr.org/track/up");
            }
        });
    </script>

</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.1514a9a0.min.js"></script>
      
    
  </body>
</html>